(()=>{"use strict";var t={680:(t,e)=>{e.__esModule=!0,e.waitElementLoaded=void 0,e.waitElementLoaded=function(t){return new Promise((function(e){if(document.getElementById(t))return e(document.getElementById(t));var n=new MutationObserver((function(){document.getElementById(t)&&(e(document.getElementById(t)),n.disconnect())}));n.observe(document.body,{childList:!0,subtree:!0})}))}},156:(t,e)=>{e.__esModule=!0,e.updateFavicon=e.getFaviconDom=void 0,e.getFaviconDom=function(t){var e=document.createElement("link");return e.rel="icon",e.href=t,e},e.updateFavicon=function(t){document.getElementsByTagName("head")[0].appendChild((0,e.getFaviconDom)(t))}},489:(t,e)=>{e.__esModule=!0,e.showNotification=e.handleNotificationClick=void 0,e.handleNotificationClick=function(t){t.preventDefault(),window.open("https://cy.iwerp.net/portal/")},e.showNotification=function(t,n){new Notification(t,n).onclick=e.handleNotificationClick}},488:t=>{t.exports=moment}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var c=e[o]={exports:{}};return t[o](c,c.exports,n),c.exports}(()=>{var t,e=n(488),o=n(156),i=n(489),c=n(680),r=function(t){var n=e(),o=t[0][0],c=t[0][2],a=o.format("HH:mm",{trim:!1}),u=c.diff(n,"minutes");return""===a?((0,i.showNotification)("記得簽到",{body:"尚未有簽到的紀錄",icon:"https://cy.iwerp.net/portal/images/chungyo.ico"}),void setTimeout(r,6e4)):u<0?((0,i.showNotification)("記得簽退",{body:"超時工作(".concat(c.fromNow(),")"),icon:"https://cy.iwerp.net/portal/images/chungyo.ico"}),void setTimeout(r,5e3)):u<30?((0,i.showNotification)("記得簽退",{body:"工作即將結束(".concat(c.fromNow(),")"),icon:"https://cy.iwerp.net/portal/images/chungyo.ico"}),void setTimeout(r,6e4*u/30)):void setTimeout(r,3e5*u/30)},a=function(t){var e=t[2].diff(t[0],"minutes");return 0===e?0:e-540},u=function(t){var n=e(),o=t.innerText.split("\t"),i="".concat(n.year(),"/").concat(o[0].split(" ")[0]),c=e("".concat(i," ").concat(o[1])),r=e("".concat(i," ").concat(o[2])),a=c.clone().add(9,"hours");return[c,a,r]},d=function(t,e){for(var n=0;n<e.length;n++){var o=t[n],i=e[n][2],c=a(e[n]),r=o.getElementsByTagName("td").item(2);0!==n?(r.innerHTML=i.format("HH:mm",{trim:!1}),r.innerHTML+=' <span style="letter-spacing:0.8px; font-weight:bold; color: '.concat(c>=0?"green":"red",'">  (').concat(c>=0?"+".concat(c):c,")</span>")):(r.innerHTML="<h6> ".concat(i.format("HH:mm",{trim:!1})," </h6>"),r.innerHTML+="<div> ".concat(i.fromNow()," </div>"))}setTimeout((function(){d(t,e)}),6e4)};e.locale("zh-tw"),(0,o.updateFavicon)("https://cy.iwerp.net/portal/images/chungyo.ico"),t=function(t){var e=t.getElementsByTagName("tr"),n=function(t){for(var e=[],n=0;n<t.length;n++){var o=t[n];if(!0===/\([日|六]\)/.test(o.innerText))break;e.push(u(o))}return e}(e);n[0][2]=n[0][2].clone().subtract(function(t){for(var e=0,n=0,o=t;n<o.length;n++){var i=o[n];e+=a(i)}return e}(n),"minutes"),d(e,n),r(n)},window.MutationObserver&&new MutationObserver((function(e){e.forEach((function(e){"childList"==e.type&&"formTemplate:attend_rec_panel_content"===e.target.id&&(0,c.waitElementLoaded)("formTemplate:attend_rec_datatable_data").then(t)}))})).observe(document.querySelector("body"),{childList:!0,subtree:!0})})()})();