(()=>{var e={90:e=>{e.exports=function(){"use strict";var e={"./src/index.ts":function(e,t,n){function a(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function r(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}n.r(t),n.d(t,{beginMultipartUpload:function(){return g},completeUploadPart:function(){return A},getUploadPart:function(){return p},request:function(){return o}});var o=r((function(e,t){var n=function(e,t){var n,a,r=t.path.replace(/[:]/g,"_"),o="".concat(e.BASE).concat(r);return t.query?"".concat(o).concat((n=t.query,a=[],Object.keys(n).forEach((function(e){var t=n[e];(function(e){return null!=e})(t)&&(Array.isArray(t)?t.forEach((function(t){a.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(String(t))))})):a.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(String(t)))))})),a.length>0?"?".concat(a.join("&")):"")):o}(e,t);return a(i(e,t,n),(function(e){var a,r,o=(r=(a=e).getResponseHeader(u))?r.toLowerCase().startsWith(s)?JSON.parse(a.responseText):a.responseText:null,i=function(e,t){return t?e.getResponseHeader(t):null}(e,t.responseHeader);return{url:n,ok:e.status>=200&&e.status<300,status:e.status,statusText:e.statusText,body:i||o}}))})),i=r((function(e,t,n){var r=new XMLHttpRequest;return r.open(t.method,n,!0),r.withCredentials=e.WITH_CREDENTIALS,a(c(e,t),(function(e){return e.forEach((function(e,t){r.setRequestHeader(t,e)})),new Promise((function(e){r.onreadystatechange=function(){r.readyState===XMLHttpRequest.DONE&&e(r)},r.send(function(e){if(e.body)return JSON.stringify(e.body)}(t))}))}))})),c=r((function(e,t){return a(l(t,e.USERNAME),(function(n){return a(l(t,e.PASSWORD),(function(r){return a(l(t,e.HEADERS),(function(e){var a=new Headers(Object.assign(Object.assign({Accept:s},e),t.headers));if(d(n)&&d(r)){var o=btoa("".concat(n,":").concat(r));a.append("Authorization","Basic ".concat(o))}return t.body&&a.append(u,s),a}))}))}))})),l=r((function(e,t){return"function"==typeof t?t(e):t})),u="Content-Type",s="application/json";function d(e){return"string"==typeof e&&""!==e}function f(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var p=f((function(e,t,n,a){return o(e,{method:"GET",path:"".concat(m).concat(t).concat(h,"/").concat(n).concat(v).concat(a)})})),A=f((function(e,t,n,a,r){return o(e,{method:"PUT",path:"".concat(m).concat(t).concat(h,"/").concat(n).concat(v).concat(a),body:r})})),g=f((function(e,t,n){return o(e,{method:"POST",path:"".concat(m).concat(t).concat(h),body:n})})),m="/v2/accounts/",h="/uploads",v="/parts/"}},t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}return n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n("./src/index.ts")}()},285:()=>{class e extends HTMLElement{constructor(){super(),this.link=document.createElement("link"),this.link.setAttribute("rel","shortcut icon"),this.image=document.createElement("img"),this.image.onload=()=>this.updateIcon(),this.badgeBackgroundImage=document.createElement("img"),this.badgeBackgroundImage.onload=()=>this.updateIcon(),this.canvas=document.createElement("canvas"),this.canvas.width=e.favIconSize,this.canvas.height=e.favIconSize,document.head.appendChild(this.link),this.updateSrc(),this.updateBadgeBackgroundSrc()}static get observedAttributes(){return["src","badge","badgeBackgroundSrc","badgeColor","textColor","badgeSize"]}get src(){return this.getAttribute("src")}set src(e){this.setAttribute("src",e)}get badgeBackgroundSrc(){return this.getAttribute("badgeBackgroundSrc")}set badgeBackgroundSrc(e){this.setAttribute("badgeBackgroundSrc",e)}get badgeSize(){return parseInt(this.getAttribute("badgeSize"))||10}set badgeSize(e){this.setAttribute("badgeSize",e.toString())}get badge(){return this.getAttribute("badge")}set badge(e){this.setAttribute("badge",e)}get badgeColor(){return this.getAttribute("badgeColor")||"red"}set badgeColor(e){this.setAttribute("badgeColor",e)}get textColor(){return this.getAttribute("textColor")||"black"}set textColor(e){this.setAttribute("textColor",e)}attributeChangedCallback(e,t,n){switch(e){case"src":this.updateSrc();break;case"badgeBackgroundSrc":this.updateBadgeBackgroundSrc();break;case"badge":case"badgeColor":case"textColor":this.updateIcon()}}updateSrc(){this.image.src=this.src}updateBadgeBackgroundSrc(){this.badgeBackgroundSrc&&(this.badgeBackgroundImage.src=this.badgeBackgroundSrc)}updateIcon(){const t=this.canvas.getContext("2d");t.clearRect(0,0,e.favIconSize,e.favIconSize),t.drawImage(this.image,0,0,e.favIconSize,e.favIconSize);const n=this.badgeSize;var a;(""==(a=this.badge)||0!=a&&"false"!=a)&&(this.badgeBackgroundSrc?t.drawImage(this.badgeBackgroundImage,this.canvas.width-n,this.canvas.height-n,n,n):this.drawBadgeCircle(t,this.badgeColor,n),(e=>0!=e&&"true"!==e)(this.badge)&&(t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.textColor,t.fillText(this.badge.slice(0,2),this.canvas.width-n/2,this.canvas.height-n/2))),this.link.href=this.canvas.toDataURL("image/png")}drawBadgeCircle(e,t,n){const a=.5*n;e.beginPath(),e.arc(this.canvas.width-a,this.canvas.height-a,a,0,2*Math.PI),e.fillStyle=this.badgeColor,e.fill()}}e.favIconSize=16,customElements.define("favicon-badge",e)},493:e=>{e.exports=function(){"use strict";var e={"./src/index.ts":function(e,t,n){function a(e){var t,n,a,r=null!==(t=e.minDelayUntilFirstValue)&&void 0!==t?t:0,o=null!==(n=e.teardownTime)&&void 0!==n?n:0,i=e.valueIncreaseRatePerSecond,c=e.averageTimeBetweenValues,l=e.maxValue,u=e.valueIncreaseDelta,s=Date.now(),d=0,f=0;function p(e){return e.value===l}function A(e,t,n){var a=function(e,t){return 1-Math.exp(-(e-t)/(3.5*c))}(t,n);return a*e+(1-a)*f}function g(e){return t=null!=e?e:Date.now(),(n=void 0!==a?function(e,t){if(p(e)){var n=Math.max(1e3,o),a=(t-e.time)/n,r=(c=Math.min(1,a))*c,i=e.value-f;return f+i*r}var c;return A(e.value,t,s)}(a,t):function(e){var t=Math.min(u,.33*l),n=(e-s)/(r+t/i*1e3);return Math.min(1,n)*t}(t))>d&&(d=n),d;var t,n}return{setValue:function(e,t){if(void 0!==a){if(p(a))return;f=A(a.value,a.time,s),s=a.time}a={time:null!=t?t:Date.now(),value:Math.min(e,l)}},smoothedValue:g,smoothedFactor:function(e){return g(e)/l}}}n.r(t),n.d(t,{ProgressSmoother:function(){return a}})}},t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}return n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n("./src/index.ts")}()},300:(e,t,n)=>{"use strict";t.__esModule=!0;var a=n(439),r=function(){function e(){}return e.has=function(e){return null!==sessionStorage.getItem(e)},e.getByKey=function(t){return!1===e.has(t)?"":sessionStorage.getItem(t)},e.getObjectByKey=function(t){if(!1===e.has(t))return{};var n=sessionStorage.getItem(t);return!0===(0,a.isJson)(n)?JSON.parse(n):{}},e.getArrayByKey=function(t){if(!1===e.has(t))return[];var n=sessionStorage.getItem(t);return!0===(0,a.isJson)(n)?JSON.parse(n):[]},e.setByKey=function(e,t){sessionStorage.setItem(e,t)},e.toggleByKey=function(t){!1!==e.has(t)&&e.setByKey(t,JSON.stringify(!JSON.parse(e.getByKey(t))))},e.resetByKey=function(t){!0===e.has(t)&&sessionStorage.removeItem(t)},e}();t.default=r},850:(e,t)=>{"use strict";t.__esModule=!0,t.UPLOAD_JS_TOKEN=t.LINE_NOTIFY_CHANNEL_ACCESS_TOKEN=t.HAS_LINE_MESSAGE_API_AUTH=t.LINE_MESSAGING_API_ACCESS_TOKEN=t.LINE_USER_ID=void 0,t.LINE_USER_ID=GM_getValue("LINE_USER_ID",""),t.LINE_MESSAGING_API_ACCESS_TOKEN=GM_getValue("LINE_MESSAGING_API_ACCESS_TOKEN",""),t.HAS_LINE_MESSAGE_API_AUTH=""!==t.LINE_USER_ID&&""!==t.LINE_MESSAGING_API_ACCESS_TOKEN,t.LINE_NOTIFY_CHANNEL_ACCESS_TOKEN=GM_getValue("LINE_NOTIFY_CHANNEL_ACCESS_TOKEN",""),t.UPLOAD_JS_TOKEN=GM_getValue("UPLOAD_JS_TOKEN","")},835:(e,t)=>{"use strict";t.__esModule=!0,t.canvasToBlob=void 0,t.canvasToBlob=function(e){for(var t=e.toDataURL("image/png").split(";base64,"),n=t[0].split(":")[1],a=window.atob(t[1]),r=new Uint8Array(a.length),o=0;o<a.length;o++)r[o]=a.charCodeAt(o);return new Blob([r],{type:n})}},680:(e,t)=>{"use strict";t.__esModule=!0,t.waitElementLoaded=void 0,t.waitElementLoaded=function(e){if(void 0!==window.MutationObserver)return new Promise((function(t){if(document.querySelector(e))return t(document.querySelector(e));var n=new MutationObserver((function(){document.querySelector(e)&&(t(document.querySelector(e)),n.disconnect())}));n.observe(document.body,{childList:!0,subtree:!0})}));console.error("請檢查瀏覽器使否支援 MutationObserver")}},156:(e,t)=>{"use strict";t.__esModule=!0,t.insertFaviconHTML=t.updateFavicon=t.getFaviconDom=void 0,t.getFaviconDom=function(e){var t=document.createElement("link");return t.rel="icon",t.href=e,t},t.updateFavicon=function(e){document.getElementsByTagName("head")[0].appendChild((0,t.getFaviconDom)(e))},t.insertFaviconHTML=function(e){document.getElementsByTagName("head")[0].innerHTML+=e}},439:(e,t)=>{"use strict";t.__esModule=!0,t.isJson=void 0,t.isJson=function(e){try{JSON.parse(e)}catch(e){return!1}return!0}},228:(e,t,n)=>{"use strict";t.__esModule=!0,t.notify=t.sendMessages=void 0;var a=n(249),r=n(850);t.sendMessages=function(e){!1!==r.HAS_LINE_MESSAGE_API_AUTH?GM_xmlhttpRequest({url:"https://api.line.me/v2/bot/message/push",headers:{Authorization:"Bearer ".concat(r.LINE_MESSAGING_API_ACCESS_TOKEN),"Content-Type":"application/json"},data:JSON.stringify({to:r.LINE_USER_ID,messages:e}),method:"POST",onload:function(t){4===t.readyState&&200===t.status?(0,a.log)("LINE 發送成功：".concat(e[0].altText)):(0,a.log)("LINE 發送失敗：".concat(t.status))},onerror:function(n){(0,a.log)("LINE 發送失敗：".concat(JSON.stringify(n))),(0,t.notify)(JSON.stringify(e[0]))}}):(0,a.log)("請設定 LINE_MESSAGING_API_ACCESS_TOKEN 和 LINE_USER_ID 環境變數")},t.notify=function(e){""!==r.LINE_NOTIFY_CHANNEL_ACCESS_TOKEN?GM_xmlhttpRequest({url:"https://notify-api.line.me/api/notify",headers:{Authorization:"Bearer ".concat(r.LINE_NOTIFY_CHANNEL_ACCESS_TOKEN),"Content-Type":"application/x-www-form-urlencoded"},data:"message="+encodeURIComponent(e),method:"POST",onload:function(t){4===t.readyState&&200===t.status?(0,a.log)("LINE 通知成功：".concat(e)):(0,a.log)("LINE 通知失敗：".concat(t.status))},onerror:function(e){(0,a.log)("LINE 通知失敗：".concat(JSON.stringify(e)))}}):(0,a.log)("請設定 LINE_NOTIFY_CHANNEL_ACCESS_TOKEN 環境變數")}},521:(e,t)=>{"use strict";t.__esModule=!0,t.getScreenshotFlexBubble=void 0,t.getScreenshotFlexBubble=function(e,t){return{type:"bubble",size:"giga",body:{spacing:"md",type:"box",layout:"vertical",contents:[{type:"text",text:t,size:"xl",weight:"bold"},{type:"image",size:"full",aspectMode:"fit",url:e,animated:!0,aspectRatio:"16:9"}]}}}},82:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{l(a.next(e))}catch(e){o(e)}}function c(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((a=a.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};t.__esModule=!0,t.sendCanvasElementScreenshot=void 0;var o=n(228),i=n(521),c=n(10),l=n(249);t.sendCanvasElementScreenshot=function(e,t){return a(void 0,void 0,void 0,(function(){var n;return r(this,(function(a){switch(a.label){case 0:return null===e?((0,l.log)("截圖失敗：元件不存在"),[2]):[4,(0,c.getCanvasImageUrl)(e)];case 1:return n=a.sent(),(0,o.notify)("截圖成功：".concat(n)),""===n?((0,l.log)("截圖失敗：上傳圖片網址為空"),[2]):((0,o.sendMessages)([{type:"flex",altText:t,contents:(0,i.getScreenshotFlexBubble)(n,t)}]),[2])}}))}))}},249:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.log=void 0;var r=a(n(488));t.log=function(e){console.log("".concat((0,r.default)().toLocaleString(),":").concat(e))}},489:(e,t)=>{"use strict";t.__esModule=!0,t.showNotification=void 0,t.showNotification=function(e,t,n){new Notification(e,t).onclose=n}},691:(e,t)=>{"use strict";t.__esModule=!0,t.mergeObject=void 0,t.mergeObject=function(e,n){for(var a in n)try{n[a].constructor==Object?e[a]=(0,t.mergeObject)(e[a],n[a]):e[a]=n[a]}catch(t){e[a]=n[a]}return e}},199:(e,t)=>{"use strict";t.__esModule=!0,t.sleep=void 0,t.sleep=function(e){return new Promise((function(t){setTimeout(t,1e3*e)}))}},10:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{l(a.next(e))}catch(e){o(e)}}function c(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((a=a.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};t.__esModule=!0,t.getCanvasImageUrl=void 0;var o=n(502),i=n(835),c=n(850),l=n(249);t.getCanvasImageUrl=function(e){return a(void 0,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return""===c.UPLOAD_JS_TOKEN?((0,l.log)("請設定 UPLOAD_JS_TOKEN 環境變數"),[2]):[4,(0,o.Upload)({apiKey:c.UPLOAD_JS_TOKEN}).uploadFile((0,i.canvasToBlob)(e))];case 1:return[2,t.sent().fileUrl]}}))}))}},158:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{l(a.next(e))}catch(e){o(e)}}function c(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((a=a.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.updateLeaveReceiptNote=t.updateLeaveReceiptNoteView=t.appendUpdateLeaveReceiptNoteFunction=t.getSendLeaveReceiptNoteButton=t.getUpdateLeaveReceiptNoteButton=void 0;var i=o(n(488)),c=n(949),l=o(n(300)),u=o(n(116)),s=n(249),d=n(650),f=n(199),p=n(43);t.getUpdateLeaveReceiptNoteButton=function(){var e=document.querySelector("#update-leave-receipt-note");return null===e?document.createElement("a"):e},t.getSendLeaveReceiptNoteButton=function(){var e=document.querySelector("#send-leave-receipt-note");return null===e?document.createElement("a"):e},t.appendUpdateLeaveReceiptNoteFunction=function(){(0,t.getUpdateLeaveReceiptNoteButton)().onclick=t.updateLeaveReceiptNote,(0,t.getSendLeaveReceiptNoteButton)().onclick=p.sendLeaveReceiptNotes},t.updateLeaveReceiptNoteView=function(e){var t=document.querySelector("#leave-receipt-note-template");null!==t&&0!==e.length&&(t.innerHTML=(0,d.getLeaveReceiptNotesTemplate)(e))},t.updateLeaveReceiptNote=function(){return a(void 0,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return(0,t.getUpdateLeaveReceiptNoteButton)().className+=" fa-spin",[4,(0,f.sleep)(1)];case 1:return n.sent(),[4,(0,c.fetchLeaveReceiptNotes)()];case 2:return e=n.sent(),l.default.setByKey(u.default.AJAX_LEAVE_RECEIPT_NOTES,JSON.stringify(e)),l.default.setByKey(u.default.AJAX_LEAVE_RECEIPT_NOTES_TIMESTAMP,String((0,i.default)().valueOf())),(0,s.log)("手動從伺服器取得請假記錄"),(0,t.updateLeaveReceiptNoteView)(e),(0,t.appendUpdateLeaveReceiptNoteFunction)(),(0,t.getUpdateLeaveReceiptNoteButton)().className=(0,t.getUpdateLeaveReceiptNoteButton)().className.replace(" fa-spin",""),[2]}}))}))}},949:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{l(a.next(e))}catch(e){o(e)}}function c(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((a=a.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.fetchLeaveReceiptNotes=t.fetchLeaveReceiptNotesAjaxPattern=t.fetchLeaveNotes=t.fetchLeaveNotesAjaxPattern=t.fetchAnnualLeave=t.fetchAnnouncement=t.fetchAllCompanyEmployeeCount=t.fetchCompanyEmployeeToken=void 0;var i=o(n(488)),c=n(350);t.fetchCompanyEmployeeToken=function(){return a(void 0,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,fetch("https://cy.iwerp.net/system/hr/showEmpData.xhtml",{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,vi;q=0.6,zh-CN;q=0.5","cache-control":"max-age=0","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://cy.iwerp.net/portal/page/new_home.xhtml",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}).then((function(e){return e.text()})).then((function(e){var t=document.createElement("html");t.innerHTML=e;var n=t.querySelector('input[id="j_id1:javax.faces.ViewState:0"]');return null===n?null:n.value.trim()}))];case 1:return[2,e.sent()]}}))}))},t.fetchAllCompanyEmployeeCount=function(){return a(void 0,void 0,void 0,(function(){var e,n,a,o;return r(this,(function(r){switch(r.label){case 0:return e=fetch,n=["https://cy.iwerp.net/system/hr/showEmpData.xhtml"],o={headers:{accept:"application/xml, text/xml, */*; q=0.01","accept-language":"zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,vi;q=0.6,zh-CN;q=0.5","content-type":"application/x-www-form-urlencoded; charset=UTF-8","faces-request":"partial/ajax","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://cy.iwerp.net/system/hr/showEmpData.xhtml",referrerPolicy:"strict-origin-when-cross-origin"},a="javax.faces.partial.ajax=true&javax.faces.source=id_dataTable&javax.faces.partial.execute=id_dataTable&javax.faces.partial.render=id_dataTable&id_dataTable=id_dataTable&id_dataTable_filtering=true&id_dataTable_encodeFeature=true&formTemplate=formTemplate&j_idt20_selection=0&id_dataTable%3Aj_idt29%3Afilter=&id_dataTable%3Aj_idt31%3Afilter=&id_dataTable%3Aj_idt32%3Afilter=&id_dataTable%3Aj_idt34%3Afilter=&id_dataTable%3Aj_idt36%3Afilter=&id_dataTable_scrollState=0%2C0&javax.faces.ViewState=".concat,[4,(0,t.fetchCompanyEmployeeToken)()];case 1:return[4,e.apply(void 0,n.concat([(o.body=a.apply("javax.faces.partial.ajax=true&javax.faces.source=id_dataTable&javax.faces.partial.execute=id_dataTable&javax.faces.partial.render=id_dataTable&id_dataTable=id_dataTable&id_dataTable_filtering=true&id_dataTable_encodeFeature=true&formTemplate=formTemplate&j_idt20_selection=0&id_dataTable%3Aj_idt29%3Afilter=&id_dataTable%3Aj_idt31%3Afilter=&id_dataTable%3Aj_idt32%3Afilter=&id_dataTable%3Aj_idt34%3Afilter=&id_dataTable%3Aj_idt36%3Afilter=&id_dataTable_scrollState=0%2C0&javax.faces.ViewState=",[r.sent()]),o.method="POST",o.mode="cors",o.credentials="include",o)])).then((function(e){return e.text()})).then((function(e){var t=document.createElement("html");t.innerHTML=e;var n=t.querySelector("extension");return null===n?null:Number(JSON.parse(n.innerText.trim()).totalRecords)}))];case 2:return[2,r.sent()]}}))}))},t.fetchAnnouncement=function(e){return a(void 0,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,fetch("https://cy.iwerp.net/anno/page/annoView/View.xhtml?sid=".concat(e),{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7","accept-language":"zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,vi;q=0.6,zh-CN;q=0.5","cache-control":"no-cache",pragma:"no-cache","sec-ch-ua":'"Google Chrome";v="111", "Not(A:Brand";v="8", "Chromium";v="111"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://cy.iwerp.net/portal/page/new_home.xhtml",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}).then((function(e){return e.text()})).then((function(e){var t=document.createElement("html");t.innerHTML=e;var n=t.querySelector("[id^='AnnoViewForm:j_idt'] > tbody > tr:nth-child(2) > td:nth-child(2)"),a=t.querySelector("[id^='AnnoViewForm:j_idt'] > tbody > tr:nth-child(5) > td:nth-child(2) > div > div"),r=t.querySelector("[id^='AnnoViewForm:j_idt'] > tbody > tr:nth-child(3) > td:nth-child(2)"),o=t.querySelector("[id^='AnnoViewForm:j_idt'] > tbody > tr:nth-child(6) > td:nth-child(2)");return{type:n.innerText.trim(),duration:a.innerText.trim(),subject:r.innerText.trim(),content:o.innerText.trim()}}))];case 1:return[2,t.sent()]}}))}))},t.fetchAnnualLeave=function(){return a(void 0,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return[4,(0,t.fetchLeaveReceiptNotesAjaxPattern)()];case 1:return e=n.sent().session,[4,fetch("https://cy.iwerp.net/hr-attendance/leave/personal/personal-apply.xhtml",{headers:{accept:"application/xml, text/xml, */*; q=0.01","accept-language":"zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,vi;q=0.6,zh-CN;q=0.5","content-type":"application/x-www-form-urlencoded; charset=UTF-8","faces-request":"partial/ajax","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://cy.iwerp.net/hr-attendance/leave/personal/personal-apply.xhtml",referrerPolicy:"strict-origin-when-cross-origin",body:"javax.faces.partial.ajax=true&javax.faces.source=new-btn&javax.faces.partial.execute=new-btn&javax.faces.partial.render=new-btn+id_tag_toolbar_view+containter&new-btn=new-btn&formTemplate=formTemplate&j_idt154_input=2022%2F11%2F26&j_idt158_input=2022%2F12%2F25&j_idt166_focus=&j_idt166_input=&j_idt170_focus=&j_idt170_input=&j_idt179_focus=&j_idt179_input=0&aply-data-tb%3Aj_idt193%3Afilter=&aply-data-tb%3Aj_idt195%3Afilter=&aply-data-tb%3Aj_idt197%3Afilter=&aply-data-tb%3Aj_idt199%3Afilter=&aply-data-tb%3Aj_idt202%3Afilter=&aply-data-tb%3Aj_idt204%3Afilter=&aply-data-tb%3Aj_idt206%3Afilter=&aply-data-tb%3Aj_idt208%3Afilter=&aply-data-tb%3Aj_idt210%3Afilter=&aply-data-tb%3Aj_idt215_focus=&aply-data-tb%3Aj_idt215_input=&aply-data-tb%3Aj_idt219%3Afilter=&aply-data-tb%3Aj_idt222_focus=&aply-data-tb%3Aj_idt222_input=&aply-data-tb%3Aj_idt227_focus=&aply-data-tb%3Aj_idt227_input=&aply-data-tb%3Aj_idt232_focus=&aply-data-tb%3Aj_idt232_input=&aply-data-tb_selection=&aply-data-tb_scrollState=0%2C0&j_idt672%3Adlg-leave-aply-vac-table%3Aj_idt676%3Afilter=&j_idt672%3Adlg-leave-aply-vac-table_selection=&j_idt672%3Adlg-leave-aply-vac-table_scrollState=0%2C0&j_idt729=&j_idt734%3Aj_idt744=&javax.faces.ViewState=".concat(e),method:"POST",mode:"cors",credentials:"include"}).then((function(e){return e.text()})).then((function(e){var t=document.createElement("html");t.innerHTML=e;var n=t.querySelectorAll("#annual-now-year li label:nth-child(2)");return 0===n.length?null:{totalHours:parseInt(n.item(0).innerText),leaveHours:parseInt(n.item(1).innerText),notLeaveHours:parseInt(n.item(2).innerText),startDatetime:n.item(3).innerText,endDatetime:n.item(4).innerText}}))];case 2:return[2,n.sent()]}}))}))},t.fetchLeaveNotesAjaxPattern=function(){return a(void 0,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,fetch("https://cy.iwerp.net/hr-attendance/merge/personal.xhtml",{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,vi;q=0.6,zh-CN;q=0.5","cache-control":"max-age=0","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://cy.iwerp.net/portal/page/new_home.xhtml",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}).then((function(e){return e.text()})).then((function(e){var t=document.createElement("html");t.innerHTML=e;var n=t.querySelector('input[id="j_id1:javax.faces.ViewState:0"]'),a=t.querySelectorAll("#searchContent input");return null===n||a.length<2?null:{session:encodeURIComponent(n.value.trim()),searchRange:{start:a.item(0).name,end:a.item(1).name}}}))];case 1:return[2,e.sent()]}}))}))},t.fetchLeaveNotes=function(){return a(void 0,void 0,void 0,(function(){var e,n,a,o,i,l,u;return r(this,(function(r){switch(r.label){case 0:return e=(0,c.getPickedDate)(),[4,(0,t.fetchLeaveNotesAjaxPattern)()];case 1:return n=r.sent(),a=n.searchRange,o=n.session,i=e.day(5).format("YYYY/MM/DD",{trim:!1}),l=e.day(1).format("YYYY/MM/DD",{trim:!1}),u="&".concat(a.start,"=").concat(l,"&").concat(a.end,"=").concat(i),[2,fetch("https://cy.iwerp.net/hr-attendance/merge/personal.xhtml",{headers:{accept:"application/xml, text/xml, */*; q=0.01","accept-language":"zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,vi;q=0.6,zh-CN;q=0.5","content-type":"application/x-www-form-urlencoded; charset=UTF-8","faces-request":"partial/ajax","sec-ch-ua":'"Google Chrome";v="107", "Chromium";v="107", "Not=A?Brand";v="24"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://cy.iwerp.net/hr-attendance/merge/personal.xhtml",referrerPolicy:"strict-origin-when-cross-origin",body:"javax.faces.partial.ajax=true&javax.faces.source=search-btn&javax.faces.partial.execute=search-btn+searchContent&javax.faces.partial.render=search-btn+id_tag_toolbar_view+opDt&search-btn=search-btn&formTemplate=formTemplate&j_idt152_input=2022%2F11%2F26&j_idt156_input=2022%2F12%2F25&kind_focus=&kind_input=ALL&dt_scrollState=0%2C0&javax.faces.ViewState=".concat(o).replace(/&j_idt152_input=\d+%2F\d+%2F\d+&j_idt156_input=\d+%2F\d+%2F\d+/,u),method:"POST",mode:"cors",credentials:"include"}).then((function(e){return e.text()})).then((function(e){var t=[],n=document.createElement("html");return n.innerHTML=e,n.querySelectorAll(".ui-datatable-frozenlayout-right tbody tr").forEach((function(e,a){var r=n.querySelector(".ui-datatable-frozenlayout-left tbody tr:nth-child(".concat(a+1,") td:nth-child(5)")),o=e.querySelectorAll("td").item(2),i=e.querySelectorAll("td").item(5),c=e.querySelectorAll("td").item(3);null!==o&&null!==i&&null!==c&&(t[a+1]={datetime:r.innerText.trim(),unusualNote:o.innerText.trim(),unsignedNote:i.innerText.trim(),receiptNote:c.innerText.trim()})})),t}))]}}))}))},t.fetchLeaveReceiptNotesAjaxPattern=function(){return a(void 0,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,fetch("https://cy.iwerp.net/hr-attendance/leave/personal/personal-apply.xhtml",{headers:{accept:"text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9","accept-language":"zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,vi;q=0.6,zh-CN;q=0.5","cache-control":"no-cache",pragma:"no-cache","sec-ch-ua":'"Not?A_Brand";v="8", "Chromium";v="108", "Google Chrome";v="108"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"document","sec-fetch-mode":"navigate","sec-fetch-site":"same-origin","sec-fetch-user":"?1","upgrade-insecure-requests":"1"},referrer:"https://cy.iwerp.net/portal/page/new_home.xhtml",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors",credentials:"include"}).then((function(e){return e.text()})).then((function(e){var t=document.createElement("html");t.innerHTML=e;var n=t.querySelector('input[id="j_id1:javax.faces.ViewState:0"]'),a=t.querySelectorAll("#searchContent input");return null===n||a.length<2?null:{session:encodeURIComponent(n.value.trim()),searchRange:{start:a.item(0).name,end:a.item(1).name}}}))];case 1:return[2,e.sent()]}}))}))},t.fetchLeaveReceiptNotes=function(){return a(void 0,void 0,void 0,(function(){var e,n,a,o,c,l;return r(this,(function(r){switch(r.label){case 0:return[4,(0,t.fetchLeaveReceiptNotesAjaxPattern)()];case 1:return e=r.sent(),n=e.session,a=e.searchRange,o=(0,i.default)().add(2,"months").format("YYYY/MM/DD",{trim:!1}),c=(0,i.default)().subtract(7,"days").format("YYYY/MM/DD",{trim:!1}),l="&".concat(a.start,"=").concat(c,"&").concat(a.end,"=").concat(o),[2,fetch("https://cy.iwerp.net/hr-attendance/leave/personal/personal-apply.xhtml",{headers:{accept:"application/xml, text/xml, */*; q=0.01","accept-language":"zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7,vi;q=0.6,zh-CN;q=0.5","cache-control":"no-cache","content-type":"application/x-www-form-urlencoded; charset=UTF-8","faces-request":"partial/ajax",pragma:"no-cache","sec-ch-ua":'"Not?A_Brand";v="8", "Chromium";v="108", "Google Chrome";v="108"',"sec-ch-ua-mobile":"?0","sec-ch-ua-platform":'"macOS"',"sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest"},referrer:"https://cy.iwerp.net/hr-attendance/leave/personal/personal-apply.xhtml",referrerPolicy:"strict-origin-when-cross-origin",body:"javax.faces.partial.ajax=true&javax.faces.source=search-btn&javax.faces.partial.execute=search-btn+searchContent&javax.faces.partial.render=search-btn+id_tag_toolbar_view+leaveaply-datatable&search-btn=search-btn&formTemplate=formTemplate&j_idt154_input=2022%2F11%2F26&j_idt158_input=2022%2F12%2F25&j_idt166_focus=&j_idt166_input=&j_idt170_focus=&j_idt170_input=&j_idt179_focus=&j_idt179_input=0&aply-data-tb%3Aj_idt193%3Afilter=&aply-data-tb%3Aj_idt195%3Afilter=&aply-data-tb%3Aj_idt197%3Afilter=&aply-data-tb%3Aj_idt199%3Afilter=&aply-data-tb%3Aj_idt202%3Afilter=&aply-data-tb%3Aj_idt204%3Afilter=&aply-data-tb%3Aj_idt206%3Afilter=&aply-data-tb%3Aj_idt208%3Afilter=&aply-data-tb%3Aj_idt210%3Afilter=&aply-data-tb%3Aj_idt215_focus=&aply-data-tb%3Aj_idt215_input=HOUR&aply-data-tb%3Aj_idt219%3Afilter=&aply-data-tb%3Aj_idt222_focus=&aply-data-tb%3Aj_idt222_input=&aply-data-tb%3Aj_idt227_focus=&aply-data-tb%3Aj_idt227_input=&aply-data-tb%3Aj_idt232_focus=&aply-data-tb%3Aj_idt232_input=&aply-data-tb_selection=&aply-data-tb_scrollState=0%2C0&j_idt672%3Adlg-leave-aply-vac-table%3Aj_idt676%3Afilter=&j_idt672%3Adlg-leave-aply-vac-table_selection=&j_idt672%3Adlg-leave-aply-vac-table_scrollState=0%2C0&j_idt729=&j_idt734%3Aj_idt744=&javax.faces.ViewState=".concat(n).replace(/&j_idt154_input=\d+%2F\d+%2F\d+&j_idt158_input=\d+%2F\d+%2F\d+/,l),method:"POST",mode:"cors",credentials:"include"}).then((function(e){return e.text()})).then((function(e){var t=[],n=document.createElement("html");return n.innerHTML=e,n.querySelectorAll(".ui-datatable-scrollable-body tbody tr:not(.ui-datatable-empty-message)").forEach((function(e){var n=e.getElementsByTagName("td");if(0!==n.length){var a=n.item(6),r=n.item(7),o=n.item(8),c=n.item(9),l=n.item(10),u=n.item(11),s=n.item(12),d=n.item(15),f=n.item(17);null!==a&&null!==d&&t.push({id:e.getAttribute("data-rk").trim(),type:a.innerText.trim(),note:r.innerText.trim(),start:(0,i.default)("".concat(o.innerText.trim()," ").concat(c.innerText.trim())),end:(0,i.default)("".concat(l.innerText.trim()," ").concat(u.innerText.trim())),hours:Number(s.innerText.trim()),status:d.innerText.trim(),isCanceled:"是"===f.innerText.trim()})}})),t}))]}}))}))}},679:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{l(a.next(e))}catch(e){o(e)}}function c(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((a=a.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}};t.__esModule=!0,t.prependSendAnnouncementButtons=void 0;var o=n(1),i=n(949),c=n(43),l=n(850);t.prependSendAnnouncementButtons=function(e){var t=Array.from(e.querySelectorAll("tr"));if(!1!==l.HAS_LINE_MESSAGE_API_AUTH)for(var n=function(e){var t=e.querySelector("td"),n=e.querySelectorAll("td > a").item(0).href,l=new URLSearchParams(new URL(n).search).get("sid"),u=(0,o.getSendIcon)();u.onclick=function(){return a(void 0,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return[4,(0,i.fetchAnnouncement)(l)];case 1:return e=t.sent(),[4,(0,c.sendAnnouncement)(e)];case 2:return t.sent(),[2]}}))}))},t.innerHTML="",t.insertAdjacentElement("afterbegin",u)},u=0,s=t;u<s.length;u++)n(s[u])}},363:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{l(a.next(e))}catch(e){o(e)}}function c(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((a=a.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.updateAnnualLeave=t.updateAnnualLeaveView=t.appendUpdateAnnualLeaveFunction=t.getSendAnnualLeaveButton=t.getUpdateAnnualLeaveButton=void 0;var i=o(n(488)),c=n(949),l=o(n(300)),u=o(n(116)),s=n(249),d=n(650),f=n(199),p=n(43);t.getUpdateAnnualLeaveButton=function(){var e=document.querySelector("#update-annual-leave");return null===e?document.createElement("a"):e},t.getSendAnnualLeaveButton=function(){var e=document.querySelector("#send-annual-leave");return null===e?document.createElement("a"):e},t.appendUpdateAnnualLeaveFunction=function(){(0,t.getUpdateAnnualLeaveButton)().onclick=t.updateAnnualLeave,(0,t.getSendAnnualLeaveButton)().onclick=p.sendAnnualLeave},t.updateAnnualLeaveView=function(e){var t=document.querySelector("#annual-leave-template");null!==t&&null!==e&&(t.innerHTML=(0,d.getAnnualLeaveTemplate)(e))},t.updateAnnualLeave=function(){return a(void 0,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return(0,t.getUpdateAnnualLeaveButton)().className+=" fa-spin",[4,(0,f.sleep)(1)];case 1:return n.sent(),[4,(0,c.fetchAnnualLeave)()];case 2:return e=n.sent(),l.default.setByKey(u.default.AJAX_ANNUAL_LEAVE,JSON.stringify(e)),l.default.setByKey(u.default.AJAX_ANNUAL_LEAVE_TIMESTAMP,String((0,i.default)().valueOf())),(0,s.log)("手動從伺服器取得特休記錄"),(0,t.updateAnnualLeaveView)(e),(0,t.appendUpdateAnnualLeaveFunction)(),(0,t.getUpdateAnnualLeaveButton)().className=(0,t.getUpdateAnnualLeaveButton)().className.replace(" fa-spin",""),[2]}}))}))}},198:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.getAttendanceTableElement=t.updatePredictedSignOutTemplate=t.updateAttendanceSummary=void 0;var r=a(n(488)),o=n(350),i=n(71),c=n(650),l=n(1),u=n(606),s=n(850);t.updateAttendanceSummary=function(e){document.querySelector("#formTemplate\\:attend_rec_datatable > div > table > tfoot > tr > td:nth-child(3)").innerHTML=(0,c.getAttendanceSummaryTemplate)(e)},t.updatePredictedSignOutTemplate=function(e){document.querySelector("#formTemplate\\:attend_rec_datatable > div > table > tbody > tr:not(.progress-bar-tr):nth-child(".concat(6-(0,r.default)().day(),") > td:nth-child(3)")).innerHTML=(0,c.getAttendanceSignOutTemplate)((0,u.getTodayAttendance)(e))},t.getAttendanceTableElement=function(e){var t,n=document.createElement("table");return n.style.height="100%",n.append(((t=document.createElement("thead")).innerHTML='\n        <tr>\n          <th style="width:100px">\n            班表日\n          </th>\n          <th>\n            簽到\n          </th>\n          <th>\n            簽退\n          </th>\n          <th style="width:150px">\n            請假/異常\n            <i id="update-leave-note" class="fa fa-refresh" style="cursor: pointer;"></i>\n            '.concat(!0===s.HAS_LINE_MESSAGE_API_AUTH?(0,l.getSendIcon)("send-leave-note").outerHTML:"","\n          </th>\n        </tr>\n    "),t.style.height="35px",t)),n.append(function(e){var t=document.createElement("tbody");t.style.height="fit-content";for(var n=1;n<e.length;n++){var a=e[n],r=document.createElement("tr");!1===(0,o.isToday)(a.signInDate)&&(r.style.opacity="0.5"),!0===(0,o.isToday)(a.signInDate)&&t.insertAdjacentHTML("afterbegin",(0,i.getPredictedProgressBar)(e)),r.innerHTML=(0,c.getAttendanceDateTemplate)(a),r.innerHTML+=(0,c.getAttendanceSignInTemplate)(a),r.innerHTML+=(0,c.getAttendanceSignOutTemplate)(a),r.innerHTML+=(0,c.getLeaveNoteTemplate)(a.leaveNote),t.prepend(r)}return t}(e)),n.append(function(e){var t=document.createElement("tfoot");return t.innerHTML='\n        <tr style="border-top: solid 1px darkgrey;">\n            <td>小計</td>\n            <td></td>\n            <td>'.concat((0,c.getAttendanceSummaryTemplate)(e),"</td>\n            <td>").concat((0,l.getCopyrightAndVersionElement)().outerHTML,"</td>\n        </tr>\n    "),t}(e)),n}},606:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.getPredictedSignOutDate=t.getRemainMinutes=t.getLeaveMinutes=t.isNoBackLeaveNote=t.getWorkingMinutes=t.getTotalRemainMinutes=t.getSummaryRemainMinutes=t.filterUndefinedAttendance=t.formatAttendance=t.getTodayAttendance=t.getWeekAttendances=void 0;var o=r(n(488)),i=n(537),c=n(350);t.getWeekAttendances=function(e){for(var t=(0,c.getPickedDate)(),n=[],a=1;a<6;a++){var r=(0,o.default)(t.day(a).format("YYYY/MM/DD 00:00",{trim:!1}));n[a]={signInDate:r,signOutDate:r,leaveNote:void 0===e[a]?i.defaultLeaveNote:e[a]}}return n},t.getTodayAttendance=function(e){return e[(0,o.default)().day()]},t.formatAttendance=function(e){return a(a({},e),{signInDate:(0,c.formatEarliestSignInDate)(e.signInDate)})},t.filterUndefinedAttendance=function(e){return e.filter(Boolean)},t.getSummaryRemainMinutes=function(e){for(var n=0,a=0,r=(0,t.filterUndefinedAttendance)(e);a<r.length;a++){var i=r[a],l=i.signInDate.clone().add(9,"hours").diff((0,o.default)(),"minutes");if(""!==(0,c.formatTime)(i.signOutDate))n+=(0,t.getRemainMinutes)(i);else{if(""==(0,c.formatTime)(i.signInDate))continue;l<0&&(n+=Math.abs(l))}}return n},t.getTotalRemainMinutes=function(e){for(var n=0,a=0,r=(0,t.filterUndefinedAttendance)(e);a<r.length;a++){var o=r[a];n+=(0,t.getRemainMinutes)(o)}return n},t.getWorkingMinutes=function(e){var n=(0,t.formatAttendance)(e),a=n.signOutDate,r=n.signInDate;return a.diff(r,"minutes")},t.isNoBackLeaveNote=function(e){return e.receiptNote.includes("1800")},t.getLeaveMinutes=function(e){var n=e.signInDate,a=e.leaveNote,r=a.receiptNote.match(/^(?<leaveTime>\d+)-(?<backTime>\d+).+$/);if(null===r||0===r.length)return 0;var i=r.groups,c=i.leaveTime,l=i.backTime,u=n.format("YYYY/MM/DD",{trim:!1}),s=(0,o.default)("".concat(u," ").concat(c.slice(0,2),":").concat(c.slice(2,4))),d=(0,o.default)("".concat(u," ").concat(l.slice(0,2),":").concat(l.slice(2,4)));return!1===(0,t.isNoBackLeaveNote)(a)&&n.isBefore(s)?0:d.diff(s,"minutes")},t.getRemainMinutes=function(e){return 0===(0,t.getWorkingMinutes)(e)?0:(0,t.getWorkingMinutes)(e)+(0,t.getLeaveMinutes)(e)-540},t.getPredictedSignOutDate=function(e){var n=(0,t.getTodayAttendance)(e),a=(0,t.formatAttendance)(n),r=a.signOutDate,o=a.leaveNote,i=r.clone().subtract((0,t.getTotalRemainMinutes)(e),"minutes");return!0===(0,t.isNoBackLeaveNote)(o)?i:(0,c.formatEarliestSignOutDate)(i)}},795:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.getPickedYear=t.getPickedDateString=void 0;var r=a(n(488));t.getPickedDateString=function(){var e=document.querySelector("input.ui-state-default");return null===e?(0,r.default)().format("YYYY/MM/DD",{trim:!1}):e.value},t.getPickedYear=function(){return Number((0,t.getPickedDateString)().split("/")[0])}},160:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{l(a.next(e))}catch(e){o(e)}}function c(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.updateCompanyEmployeeCount=t.updateCompanyEmployeeCountView=t.appendUpdateCompanyEmployeeCountFunction=t.getSendCompanyEmployeeCountButton=t.getUpdateCompanyEmployeeCountButton=t.displayCompanyEmployeeCountLineChart=t.OLD_COMPANY_EMPLOYEE_COUNT=void 0;var c=i(n(488)),l=n(980),u=n(691),s=n(199),d=n(949),f=i(n(300)),p=i(n(116)),A=n(249),g=n(650),m=n(43);t.OLD_COMPANY_EMPLOYEE_COUNT={2022:{52:1497,53:1497},2023:{1:1498,2:1496,3:1475,5:1448,6:1401,7:1396,8:1379,9:1365,10:1356,11:1353,12:1343,13:1330,14:1319}},t.displayCompanyEmployeeCountLineChart=function(e){return r(void 0,void 0,void 0,(function(){var n,a,r,i,c;return o(this,(function(o){for(i in n=(0,u.mergeObject)(e,t.OLD_COMPANY_EMPLOYEE_COUNT),a=document.getElementById("company_employee_count"),r=[],n)for(c in n[i])r.push({label:"".concat(i,"/").concat(c," 週"),count:n[i][c]});return new l.Chart(a,{type:"line",data:{labels:r.map((function(e){return e.label})),datasets:[{data:r.map((function(e){return e.count})),fill:!1,borderColor:"rgb(75, 192, 192)"}]},options:{plugins:{legend:{display:!1},tooltip:{xAlign:"right",yAlign:"top"}},scales:{x:{ticks:{font:{size:10}}}}}}),[2]}))}))},t.getUpdateCompanyEmployeeCountButton=function(){var e=document.querySelector("#update-company-employee-count");return null===e?document.createElement("a"):e},t.getSendCompanyEmployeeCountButton=function(){var e=document.querySelector("#send-company-employee-count");return null===e?document.createElement("a"):e},t.appendUpdateCompanyEmployeeCountFunction=function(){(0,t.getUpdateCompanyEmployeeCountButton)().onclick=t.updateCompanyEmployeeCount,(0,t.getSendCompanyEmployeeCountButton)().onclick=m.sendCompanyEmployeeCountChart},t.updateCompanyEmployeeCountView=function(){var e=document.querySelector("#company-employee-count-template");null!==e&&(e.innerHTML=(0,g.getCompanyEmployeeTemplate)())},t.updateCompanyEmployeeCount=function(){return r(void 0,void 0,void 0,(function(){var e,n,r,i,l;return o(this,(function(o){switch(o.label){case 0:return(0,t.getUpdateCompanyEmployeeCountButton)().className+=" fa-spin",[4,(0,s.sleep)(1)];case 1:return o.sent(),[4,(0,d.fetchAllCompanyEmployeeCount)()];case 2:return e=o.sent(),f.default.setByKey(p.default.AJAX_COMPANY_EMPLOYEE_COUNT_TIMESTAMP,String((0,c.default)().valueOf())),null===e?[2]:(n=(0,c.default)().year(),r=(0,c.default)().week(),(i=f.default.getObjectByKey(p.default.AJAX_COMPANY_EMPLOYEE_COUNT))[n]=a(a({},i[n]),((l={})[r]=e,l)),f.default.setByKey(p.default.AJAX_COMPANY_EMPLOYEE_COUNT,JSON.stringify(i)),(0,A.log)("從伺服器取得公司職員狀況"),(0,t.updateCompanyEmployeeCountView)(),(0,t.appendUpdateCompanyEmployeeCountFunction)(),[4,(0,t.displayCompanyEmployeeCountLineChart)(i)]);case 3:return o.sent(),(0,t.getUpdateCompanyEmployeeCountButton)().className=(0,t.getUpdateCompanyEmployeeCountButton)().className.replace(" fa-spin",""),[2]}}))}))}},164:(e,t)=>{"use strict";t.__esModule=!0,t.convertEmptyStringToDash=void 0,t.convertEmptyStringToDash=function(e){return""===e?"-":e}},582:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.updateAttendanceFavicon=t.initializeFaviconBadge=void 0;var r=a(n(488)),o=n(606),i=n(350),c=n(156);t.initializeFaviconBadge=function(){document.querySelectorAll("favicon-badge").forEach((function(e){e.remove()})),document.querySelectorAll('link[rel="shortcut icon"]').forEach((function(e){e.remove()})),(0,c.insertFaviconHTML)('<favicon-badge src="" />')},t.updateAttendanceFavicon=function(e){var t=(0,o.getTodayAttendance)(e),n=(0,o.formatAttendance)(t),a=n.signOutDate,c=n.signInDate,l=(0,o.getPredictedSignOutDate)(e),u=l.diff((0,r.default)(),"minutes"),s=c.clone().add(9,"hours").diff((0,r.default)(),"minutes"),d=document.querySelector("favicon-badge");return d.textColor="white",d.badgeSize=16,""===(0,i.formatTime)(t.signInDate)?(document.title="未簽到",d.badgeColor="#cc0000",void(d.badge="未")):""!==(0,i.formatTime)(a)?(document.title="已經簽退",d.badgeColor="#3399ff",void(d.badge="離")):(u>30?(document.title="預計 ".concat(l.fromNow()),d.badgeColor="#737373",d.badge="".concat(l.fromNow().match(/(\d+)\s.+/)[1],"H")):u>0?(document.title="預計 ".concat(u.toString()," 分鐘後"),d.badgeColor="#006600",d.badge=u.toString()):(document.title="符合下班條件",d.badgeColor="#e69500",d.badge="可"),void(u<0&&s<0&&(document.title="超時工作(+".concat(Math.abs(s),")"),d.badgeColor="#cc0000",d.badge="超")))}},537:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{l(a.next(e))}catch(e){o(e)}}function c(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((a=a.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.updateLeaveNote=t.updateLeaveNoteView=t.appendUpdateLeaveNoteFunction=t.getSendLeaveNoteButton=t.getUpdateLeaveNoteButton=t.defaultLeaveNote=void 0;var i=o(n(488)),c=n(650),l=n(199),u=n(949),s=o(n(300)),d=o(n(116)),f=n(249),p=n(43);t.defaultLeaveNote={datetime:"",unusualNote:"",unsignedNote:"",receiptNote:""},t.getUpdateLeaveNoteButton=function(){var e=document.querySelector("#update-leave-note");return null===e?document.createElement("a"):e},t.getSendLeaveNoteButton=function(){var e=document.querySelector("#send-leave-note");return null===e?document.createElement("a"):e},t.appendUpdateLeaveNoteFunction=function(){(0,t.getUpdateLeaveNoteButton)().onclick=t.updateLeaveNote,(0,t.getSendLeaveNoteButton)().onclick=p.sendLeaveNotes},t.updateLeaveNoteView=function(e){document.querySelectorAll("#formTemplate\\:attend_rec_datatable > div > table > tbody > tr:not(.progress-bar-tr)").forEach((function(t,n){t.querySelector("td:nth-child(4)").innerHTML=(0,c.getLeaveNoteTemplate)(e[5-n])}))},t.updateLeaveNote=function(){return a(void 0,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return(0,t.getUpdateLeaveNoteButton)().className+=" fa-spin",[4,(0,l.sleep)(1)];case 1:return n.sent(),[4,(0,u.fetchLeaveNotes)()];case 2:return e=n.sent(),s.default.setByKey(d.default.AJAX_LEAVE_NOTES,JSON.stringify(e)),s.default.setByKey(d.default.AJAX_LEAVE_NOTES_TIMESTAMP,String((0,i.default)().valueOf())),(0,f.log)("手動從伺服器取得請假/異常記錄"),(0,t.updateLeaveNoteView)(e),(0,t.appendUpdateLeaveNoteFunction)(),(0,t.getUpdateLeaveNoteButton)().className=(0,t.getUpdateLeaveNoteButton)().className.replace(" fa-spin",""),[2]}}))}))}},48:function(e,t,n){"use strict";var a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var a,r=0,o=t.length;r<o;r++)!a&&r in t||(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.getAnnouncementFlexBubble=t.getAttendancesFlexBubble=t.getAttendanceTableFooterComponent=t.getAttendanceSummaryFlexText=t.getAttendanceTableBodyComponents=t.getAttendanceSignOutLeftMinutesFlexSpan=t.getAttendanceTableHeaderComponent=t.getAnnualLeaveFlexBubble=t.getLeaveNotesFlexCarousel=t.getLeaveReceiptNotesFlexCarousel=t.getLeaveNoteFlexBubble=t.getLeaveReceiptNoteFlexBubble=t.getFlexFiller=t.getFlexSeparator=void 0;var o=r(n(488)),i=n(350),c=n(606),l=n(164);t.getFlexSeparator=function(){return{type:"separator"}},t.getFlexFiller=function(){return{type:"filler"}},t.getLeaveReceiptNoteFlexBubble=function(e){var t=(0,o.default)(e.start),n=(0,o.default)(e.end);return{type:"bubble",hero:{type:"image",url:"https://www.bonigala.com/wp-content/uploads/2013/01/holiday-mood.jpg",size:"full",aspectRatio:"16:9",aspectMode:"cover"},body:{type:"box",layout:"vertical",contents:[{type:"text",weight:"bold",size:"xl",text:"請假單"},{type:"box",layout:"vertical",margin:"lg",spacing:"sm",contents:[{type:"box",layout:"baseline",spacing:"sm",contents:[{type:"text",text:"假別",color:"#aaaaaa",size:"sm",flex:1},{type:"text",wrap:!0,color:"#666666",size:"sm",flex:5,text:e.type}]}]},{type:"box",layout:"vertical",margin:"lg",spacing:"sm",contents:[{type:"box",layout:"baseline",spacing:"sm",contents:[{type:"text",text:"日期",color:"#aaaaaa",size:"sm",flex:1},{type:"text",wrap:!0,color:"#666666",size:"sm",flex:5,text:"".concat(t.format("YYYY/MM/DD (dd) HH:mm",{trim:!1})," \t").concat(n.format("YYYY/MM/DD (dd) HH:mm",{trim:!1}))}]}]},{type:"box",layout:"vertical",margin:"lg",spacing:"sm",contents:[{type:"box",layout:"baseline",spacing:"sm",contents:[{type:"text",text:"小時",color:"#aaaaaa",size:"sm",flex:1},{type:"text",wrap:!0,color:"#666666",size:"sm",flex:5,text:String(e.hours)}]}]},{type:"box",layout:"vertical",margin:"lg",spacing:"sm",contents:[{type:"box",layout:"baseline",spacing:"sm",contents:[{type:"text",text:"狀態",color:"#aaaaaa",size:"sm",flex:1},{type:"text",wrap:!0,color:"#666666",size:"sm",flex:5,text:e.status}]}]}]}}},t.getLeaveNoteFlexBubble=function(e){var t=[{type:"box",layout:"baseline",spacing:"sm",contents:[{type:"text",text:"班表日",color:"#aaaaaa",size:"sm",flex:4},{type:"text",wrap:!0,color:"#666666",size:"sm",flex:5,text:e.datetime}]}];return""!==e.unsignedNote&&t.push({type:"box",layout:"baseline",spacing:"sm",contents:[{type:"text",text:"未簽核完成單據",color:"#aaaaaa",size:"sm",flex:4},{type:"text",wrap:!0,color:"#666666",size:"sm",flex:5,text:e.unsignedNote}]}),""!==e.unusualNote&&t.push({type:"box",layout:"baseline",spacing:"sm",contents:[{type:"text",text:"異常",color:"#aaaaaa",size:"sm",flex:4},{type:"text",wrap:!0,color:"#666666",size:"sm",flex:5,text:e.unusualNote}]}),{type:"bubble",hero:{type:"image",url:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRCf1SLT4rwk-IPRvI1rSez_c0coUXcHMGfXg&usqp=CAU",size:"5xl",aspectMode:"cover",aspectRatio:"16:8"},body:{type:"box",layout:"vertical",contents:t}}},t.getLeaveReceiptNotesFlexCarousel=function(e){for(var n=[],a=0,r=e;a<r.length;a++){var o=r[a];n.push((0,t.getLeaveReceiptNoteFlexBubble)(o))}return{type:"carousel",contents:n}},t.getLeaveNotesFlexCarousel=function(e){for(var n=[],a=0,r=e;a<r.length;a++){var o=r[a];n.push((0,t.getLeaveNoteFlexBubble)(o))}return{type:"carousel",contents:n}},t.getAnnualLeaveFlexBubble=function(e){return{type:"bubble",hero:{type:"image",url:"https://s3cdn.yourator.co/ckeditor/pictures/data/000/002/305/content/48adb844b4f92f6934358b08796d2b44979f0901.png",size:"full",aspectRatio:"18:8",aspectMode:"cover"},body:{type:"box",layout:"vertical",contents:[{type:"text",weight:"bold",size:"xl",text:"特休狀況"},{type:"box",layout:"vertical",margin:"lg",spacing:"sm",contents:[{type:"box",layout:"baseline",spacing:"sm",contents:[{type:"text",text:"已休(含在途)",color:"#aaaaaa",size:"sm",flex:3},{type:"text",wrap:!0,color:"#666666",size:"sm",flex:5,text:String(e.leaveHours)}]}]},{type:"box",layout:"vertical",margin:"lg",spacing:"sm",contents:[{type:"box",layout:"baseline",spacing:"sm",contents:[{type:"text",text:"未休",color:"#aaaaaa",size:"sm",flex:3},{type:"text",wrap:!0,color:"#666666",size:"sm",flex:5,text:String(e.notLeaveHours)}]}]},{type:"box",layout:"vertical",margin:"lg",spacing:"sm",contents:[{type:"box",layout:"baseline",spacing:"sm",contents:[{type:"text",text:"有效日",color:"#aaaaaa",size:"sm",flex:3},{type:"text",wrap:!0,color:"#666666",size:"sm",flex:5,text:e.endDatetime}]}]}]}}},t.getAttendanceTableHeaderComponent=function(){return{type:"box",layout:"horizontal",contents:[{type:"text",text:"班表日",size:"md",align:"center"},{type:"text",text:"簽到",size:"md",align:"center"},{type:"text",text:"簽退",size:"md",align:"center"}],paddingAll:"md"}},t.getAttendanceSignOutLeftMinutesFlexSpan=function(e){var t=(0,c.getRemainMinutes)(e);return""===(0,i.formatTime)(e.signOutDate)||""==(0,i.formatTime)(e.signInDate)?{type:"span",text:" "}:{type:"span",text:"(".concat(t>=0?"+".concat(t):t,")"),color:t>=0?"#008000":"#ff0000"}},t.getAttendanceTableBodyComponents=function(e){for(var n=[],a=1;a<e.length;a++)n.push({type:"box",layout:"horizontal",contents:[{type:"text",text:"".concat(e[a].signInDate.format("MM/DD",{trim:!1})," (").concat((0,i.formatWeekday)(e[a].signInDate),")"),size:"md",align:"center"},{type:"text",text:(0,l.convertEmptyStringToDash)((0,i.formatTime)(e[a].signInDate)),size:"md",align:"center"},{type:"text",size:"md",align:"center",contents:[{type:"span",text:(0,l.convertEmptyStringToDash)((0,i.formatTime)(e[a].signOutDate))},(0,t.getAttendanceSignOutLeftMinutesFlexSpan)(e[a])]}],paddingAll:"md"});return n},t.getAttendanceSummaryFlexText=function(e){var t=(0,c.getSummaryRemainMinutes)(e);return{type:"text",text:t>=0?"+".concat(t):String(t),size:"lg",weight:"bold",align:"center",color:t>=0?"#008000":"#ff0000"}},t.getAttendanceTableFooterComponent=function(e){return{type:"box",layout:"horizontal",contents:[{type:"text",text:"小計",size:"md",align:"center"},(0,t.getFlexFiller)(),(0,t.getAttendanceSummaryFlexText)(e)],paddingAll:"md"}},t.getAttendancesFlexBubble=function(e){return{type:"bubble",size:"giga",hero:{type:"image",url:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSNHTdvv_Asj1Cl4btV091kqPTVg4MsOG6NB_FEY1sbdlemb2EoNCi3OHtUx_3RiyZPiOk&usqp=CAU",size:"full",aspectRatio:"16:10",aspectMode:"cover"},body:{type:"box",layout:"vertical",contents:a(a([(0,t.getAttendanceTableHeaderComponent)(),(0,t.getFlexSeparator)()],(0,t.getAttendanceTableBodyComponents)(e),!0),[(0,t.getFlexSeparator)(),(0,t.getAttendanceTableFooterComponent)(e)],!1)}}},t.getAnnouncementFlexBubble=function(e){var t=e.duration.split("～"),n=t[0],a=t[1],r=n.trim().split(" ")[0],o=a.trim().split(" ")[0];return{type:"bubble",size:"giga",hero:{type:"image",url:"https://www.shutterstock.com/image-vector/megaphone-important-announcement-vector-flat-260nw-1949944333.jpg",aspectMode:"cover",size:"full",aspectRatio:"16:8"},body:{type:"box",layout:"vertical",contents:[{type:"text",text:e.subject,wrap:!0,size:"lg",weight:"bold"},{type:"text",text:e.type,align:"end",size:"xxs",style:"italic"},{type:"text",align:"end",size:"xxs",style:"italic",contents:[{type:"span",text:r},{type:"span",text:"~"},{type:"span",text:o}]},{type:"text",text:e.content,size:"xs",wrap:!0}]}}}},43:function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{l(a.next(e))}catch(e){o(e)}}function c(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((a=a.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.sendAnnouncement=t.sendCompanyEmployeeCountChart=t.sendAttendancesScreenshot=t.sendAttendances=t.sendAnnualLeave=t.sendLeaveNotes=t.sendLeaveReceiptNotes=t.getLinBotLeaveNotes=t.getLinBotLeaveReceiptNotes=void 0;var i=o(n(488)),c=n(410),l=n(48),u=n(249),s=n(228),d=o(n(177)),f=n(82);t.getLinBotLeaveReceiptNotes=function(){return a(void 0,void 0,void 0,(function(){var e,t,n,a;return r(this,(function(r){switch(r.label){case 0:return e=[],t=0,[4,(0,c.getLeaveReceiptNotes)()];case 1:n=r.sent(),r.label=2;case 2:if(!(t<n.length))return[3,4];if("結案"===(a=n[t]).status&&!0===(0,i.default)(a.start).isBefore((0,i.default)()))return[3,3];if(!0===a.isCanceled)return[3,3];e.push(a),r.label=3;case 3:return t++,[3,2];case 4:return[2,e.reverse()]}}))}))},t.getLinBotLeaveNotes=function(){return a(void 0,void 0,void 0,(function(){var e,t,n,a;return r(this,(function(r){switch(r.label){case 0:return e=[],t=0,[4,(0,c.getLeaveNotes)()];case 1:n=r.sent(),r.label=2;case 2:if(!(t<n.length))return[3,4];if(null===(a=n[t]))return[3,3];if(""===a.unusualNote&&""===a.unsignedNote)return[3,3];e.push(a),r.label=3;case 3:return t++,[3,2];case 4:return[2,e]}}))}))},t.sendLeaveReceiptNotes=function(){return a(void 0,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return[4,(0,t.getLinBotLeaveReceiptNotes)()];case 1:return 0===(e=n.sent()).length?((0,u.log)("近期沒有請假單可以傳送"),[2]):((0,s.sendMessages)([{type:"flex",altText:"近期您有 ".concat(e.length," 則請假單"),contents:(0,l.getLeaveReceiptNotesFlexCarousel)(e)}]),[2])}}))}))},t.sendLeaveNotes=function(){return a(void 0,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return[4,(0,t.getLinBotLeaveNotes)()];case 1:return 0===(e=n.sent()).length?((0,u.log)("近期沒有考勤異常可以傳送"),[2]):((0,s.sendMessages)([{type:"flex",altText:"近期您有 ".concat(e.length," 則考勤異常"),contents:(0,l.getLeaveNotesFlexCarousel)(e)}]),[2])}}))}))},t.sendAnnualLeave=function(){return a(void 0,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return[4,(0,c.getAnnualLeave)()];case 1:return e=t.sent(),(0,s.sendMessages)([{type:"flex",altText:"特休狀況",contents:(0,l.getAnnualLeaveFlexBubble)(e)}]),[2]}}))}))},t.sendAttendances=function(e){(0,s.sendMessages)([{type:"flex",altText:"當週出缺勤狀況",contents:(0,l.getAttendancesFlexBubble)(e)}])},t.sendAttendancesScreenshot=function(){return a(void 0,void 0,void 0,(function(){var e,t;return r(this,(function(n){switch(n.label){case 0:return e=document.querySelector("#formTemplate\\:attend_rec_datatable"),[4,(0,d.default)(e)];case 1:return t=n.sent(),[4,(0,f.sendCanvasElementScreenshot)(t,"當週出缺勤狀況")];case 2:return n.sent(),[2]}}))}))},t.sendCompanyEmployeeCountChart=function(){return a(void 0,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return e=document.querySelector("#company_employee_count"),[4,(0,f.sendCanvasElementScreenshot)(e,"公司在職人數")];case 1:return t.sent(),[2]}}))}))},t.sendAnnouncement=function(e){return a(void 0,void 0,void 0,(function(){return r(this,(function(t){return(0,s.sendMessages)([{type:"flex",altText:"公告：".concat(e.subject),contents:(0,l.getAnnouncementFlexBubble)(e)}]),[2]}))}))}},350:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.formatEarliestSignOutDate=t.formatEarliestSignInDate=t.getPickedDate=t.isToday=t.formatDatetime=t.formatTime=t.formatWeekday=void 0;var r=a(n(488)),o=n(795);t.formatWeekday=function(e){switch(e.day()){case 1:return"一";case 2:return"二";case 3:return"三";case 4:return"四";case 5:return"五";case 6:return"六";case 7:return"日"}return""},t.formatTime=function(e){var t=e.format("HH:mm",{trim:!1});return"00:00"===t?"":t},t.formatDatetime=function(e){return e.format("YYYY/MM/DD HH:mm",{trim:!1})},t.isToday=function(e){return!0===(0,r.default)().isSame(e.format("YYYY/MM/DD",{trim:!1}),"day")},t.getPickedDate=function(){return(0,r.default)((0,o.getPickedDateString)())},t.formatEarliestSignInDate=function(e){var t=e.format("YYYY/MM/DD",{trim:!1});return e.isSame((0,r.default)("".concat(t," 00:00")))?e:e.isBefore((0,r.default)("".concat(t," 08:00")))?(0,r.default)("".concat(t," 08:00")):e.isBetween((0,r.default)("".concat(t," 12:30")),(0,r.default)("".concat(t," 13:30")))?(0,r.default)("".concat(t," 13:30")):e},t.formatEarliestSignOutDate=function(e){var t=e.format("YYYY/MM/DD",{trim:!1}),n=(0,r.default)("".concat(t," 17:00"));return e.isBefore(n)?n:e}},88:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.showUpdateLogNotification=t.showAttendanceNotification=t.showCompanyNotification=void 0;var r=a(n(488)),o=n(606),i=n(350),c=a(n(300)),l=a(n(116)),u=n(489),s=n(249),d=n(642),f=n(43),p=n(228);t.showCompanyNotification=function(){var e=document.querySelectorAll("#formTemplate\\:dtAlert2_data > tr"),t=[];0!==e.length&&"無最新消息資料"!==e.item(0).innerText.trim()&&(e.forEach((function(e){t.push(e.innerText.split("\n")[0])})),(0,u.showNotification)("公告",{body:"".concat(t.join("、"),"..."),icon:d.RING_BELL_IMAGE},(function(){var e=document.querySelector("#news-top a.newClearButton");null!==e&&e.click()})),(0,p.notify)("公告：".concat(t.join("、"),"...")))},t.showAttendanceNotification=function(e){var t=(0,r.default)(),n=(0,o.getTodayAttendance)(e),a=(0,o.formatAttendance)(n),A=a.signInDate,g=a.signOutDate,m=(0,o.getPredictedSignOutDate)(e),h=m.diff(t,"minutes"),v=A.clone().add(9,"hours").diff(t,"minutes"),y=t.format("YYYYMMDD",{trim:!1});if(""!==(0,i.formatTime)(g)){if(c.default.getByKey(l.default.SIGN_OUT_ALREADY_NOTIFICATION)===y)return;return(0,u.showNotification)("已經簽退",{body:"請馬上離開辦公室",icon:d.GOOD_BYE_IMAGE},(function(){(0,s.log)("已經關閉簽到通知"),c.default.setByKey(l.default.SIGN_OUT_ALREADY_NOTIFICATION,y)})),(0,f.sendAttendances)(e),void(0,p.notify)("已經簽退：請馬上離開辦公室")}if(""!==(0,i.formatTime)(n.signInDate)){if(h<0&&v<0){if(c.default.getByKey(l.default.OFF_WORK_NOTIFICATION)===y)return;(0,u.showNotification)("記得簽退",{body:"超時工作(+".concat(Math.abs(v),")"),icon:d.GOOD_BYE_IMAGE},(function(){(0,s.log)("已經關閉超時工作通知"),c.default.setByKey(l.default.OFF_WORK_NOTIFICATION,y)})),(0,p.notify)("記得簽退：超時工作(+".concat(Math.abs(v),")"))}else if(h<30){if(c.default.getByKey(l.default.SIGN_OUT_NOTIFICATION)===y)return;if(h>0)return(0,u.showNotification)("記得簽退",{body:"預計 ".concat(m.fromNow(),"下班"),icon:d.STITCH_IN_PAINTING_IMAGE},(function(){(0,s.log)("已經關閉簽退通知"),c.default.setByKey(l.default.SIGN_OUT_NOTIFICATION,y)})),void(0,p.notify)("記得簽退：預計 ".concat(m.fromNow(),"下班"));(0,u.showNotification)("記得簽退",{body:"符合下班條件",icon:d.GOOD_BYE_IMAGE},(function(){(0,s.log)("已經關閉簽退通知"),c.default.setByKey(l.default.SIGN_OUT_NOTIFICATION,y)})),(0,p.notify)("記得簽退：符合下班條件")}}else{if(c.default.getByKey(l.default.SIGN_IN_NOTIFICATION)===y)return;(0,u.showNotification)("記得簽到",{body:"尚未有簽到的紀錄",icon:d.WARNING_IMAGE},(function(){(0,s.log)("已經關閉簽到通知"),c.default.setByKey(l.default.SIGN_IN_NOTIFICATION,y)}))}},t.showUpdateLogNotification=function(e){c.default.getByKey(l.default.UPDATE_LOG_NOTIFICATION)!==e.version&&((0,u.showNotification)("更新日誌 v".concat(e.version," (").concat((0,r.default)(e.date).fromNow(),")"),{body:"".concat(e.messages.join("、"),"..."),icon:d.NEW_VERSION_IMAGE},(function(){(0,s.log)("已經關閉更新日誌通知"),c.default.setByKey(l.default.UPDATE_LOG_NOTIFICATION,e.version)})),(0,p.notify)("更新日誌 v".concat(e.version," (").concat((0,r.default)(e.date).fromNow(),")：").concat(e.messages.join("、"),"...")),c.default.setByKey(l.default.UPDATE_LOG_NOTIFICATION,e.version))}},71:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.updatePredictedSignOutProgressBar=t.getPredictedProgressBar=t.defaultProgressBar=void 0;var o=r(n(488)),i=n(606),c=n(350),l=n(650);t.defaultProgressBar={percentage:0,leftBar:{text:"",class:""},rightBar:{text:"",color:""},textClass:""},t.getPredictedProgressBar=function(e){var n=(0,i.getTodayAttendance)(e),r=(0,i.formatAttendance)(n),u=r.signInDate;if(""===(0,c.formatTime)(n.signInDate))return"";if(""!==(0,c.formatTime)(r.signOutDate))return"";var s=(0,i.getPredictedSignOutDate)(e),d=s.diff((0,o.default)(),"minutes"),f=u.clone().add(9,"hours").diff((0,o.default)(),"minutes"),p=a(a({},t.defaultProgressBar),{leftBar:a(a({},t.defaultProgressBar.leftBar),{class:"progress-bar progress-bar-striped progress-bar-animated"}),rightBar:a(a({},t.defaultProgressBar.rightBar),{text:(0,c.formatTime)(s)})});return d>30?(p.percentage=Math.max(Math.floor(100-d/(540-(0,i.getLeaveMinutes)(r))*100),20),p.leftBar={text:"預計 ".concat(s.fromNow()),class:"".concat(p.leftBar.class," bg-secondary")},p.rightBar.color="black"):d>0?(p.percentage=Math.floor(100-d/(540-(0,i.getLeaveMinutes)(r))*100),p.leftBar={text:"預計 ".concat(d.toString()," 分鐘後"),class:"".concat(p.leftBar.class," bg-success")},p.rightBar.color="white"):(p.percentage=100,p.leftBar={text:"符合下班條件",class:"".concat(p.leftBar.class," bg-warning")},p.rightBar.color="white"),d<0&&f<0&&(p.percentage=100,p.leftBar={text:"超時工作",class:"".concat(p.leftBar.class," bg-danger")},p.rightBar.color="white"),(0,l.getProgressBarTemplate)(p)},t.updatePredictedSignOutProgressBar=function(e,n){var a=e.parentElement.querySelector("#predicted-sign-out-progress-bar");null!==a&&(a.innerHTML=(0,t.getPredictedProgressBar)(n))}},410:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{l(a.next(e))}catch(e){o(e)}}function c(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.getCompanyEmployeeCountObject=t.getLeaveReceiptNotes=t.getAnnualLeave=t.getLeaveNotes=t.isValidTimestamp=void 0;var c=i(n(488)),l=n(249),u=i(n(300)),s=i(n(116)),d=n(949);t.isValidTimestamp=function(e,t){var n=u.default.getByKey(e);return""!==n&&(0,c.default)().valueOf()-Number(n)<1e3*t},t.getLeaveNotes=function(){return r(void 0,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return!0===(0,t.isValidTimestamp)(s.default.AJAX_LEAVE_NOTES_TIMESTAMP,14400)?((0,l.log)("從本地取得請假/異常記錄"),[2,u.default.getArrayByKey(s.default.AJAX_LEAVE_NOTES)]):[4,(0,d.fetchLeaveNotes)()];case 1:return e=n.sent(),u.default.setByKey(s.default.AJAX_LEAVE_NOTES,JSON.stringify(e)),u.default.setByKey(s.default.AJAX_LEAVE_NOTES_TIMESTAMP,String((0,c.default)().valueOf())),(0,l.log)("從伺服器取得請假/異常記錄"),[2,e]}}))}))},t.getAnnualLeave=function(){return r(void 0,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return!0===(0,t.isValidTimestamp)(s.default.AJAX_ANNUAL_LEAVE_TIMESTAMP,28800)?((0,l.log)("從本地取得特休記錄"),[2,u.default.getObjectByKey(s.default.AJAX_ANNUAL_LEAVE)]):[4,(0,d.fetchAnnualLeave)()];case 1:return e=n.sent(),u.default.setByKey(s.default.AJAX_ANNUAL_LEAVE,JSON.stringify(e)),u.default.setByKey(s.default.AJAX_ANNUAL_LEAVE_TIMESTAMP,String((0,c.default)().valueOf())),(0,l.log)("從伺服器取得特休記錄"),[2,e]}}))}))},t.getLeaveReceiptNotes=function(){return r(void 0,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return!0===(0,t.isValidTimestamp)(s.default.AJAX_LEAVE_RECEIPT_NOTES_TIMESTAMP,14400)?((0,l.log)("從本地取得請假記錄"),[2,u.default.getArrayByKey(s.default.AJAX_LEAVE_RECEIPT_NOTES)]):[4,(0,d.fetchLeaveReceiptNotes)()];case 1:return e=n.sent(),u.default.setByKey(s.default.AJAX_LEAVE_RECEIPT_NOTES,JSON.stringify(e)),u.default.setByKey(s.default.AJAX_LEAVE_RECEIPT_NOTES_TIMESTAMP,String((0,c.default)().valueOf())),(0,l.log)("從伺服器取得請假記錄"),[2,e]}}))}))},t.getCompanyEmployeeCountObject=function(){return r(void 0,void 0,void 0,(function(){var e,n,r,i,f;return o(this,(function(o){switch(o.label){case 0:return!0===(0,t.isValidTimestamp)(s.default.AJAX_COMPANY_EMPLOYEE_COUNT_TIMESTAMP,28800)?((0,l.log)("從本地取得公司職員狀況"),[2,u.default.getObjectByKey(s.default.AJAX_COMPANY_EMPLOYEE_COUNT)]):[4,(0,d.fetchAllCompanyEmployeeCount)()];case 1:return e=o.sent(),u.default.setByKey(s.default.AJAX_COMPANY_EMPLOYEE_COUNT_TIMESTAMP,String((0,c.default)().valueOf())),null===e?[2]:(n=(0,c.default)().year(),r=(0,c.default)().week(),(i=u.default.getObjectByKey(s.default.AJAX_COMPANY_EMPLOYEE_COUNT))[n]=a(a({},i[n]),((f={})[r]=e,f)),u.default.setByKey(s.default.AJAX_COMPANY_EMPLOYEE_COUNT,JSON.stringify(i)),(0,l.log)("從伺服器取得公司職員狀況"),[2,i])}}))}))}},1:function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n);var r=Object.getOwnPropertyDescriptor(t,n);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,a,r)}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),r=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return r(t,e),t},i=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{l(a.next(e))}catch(e){o(e)}}function c(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((a=a.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.restyleWholePage=t.restyleAttendanceTable=t.restyleAttendanceButtons=t.prependForgottenAttendanceButton=t.prependSendAttendancesScreenshotButton=t.prependSendAttendancesButton=t.getSendIcon=t.getCameraIcon=t.createAttendanceButton=t.getCopyrightAndVersionElement=t.stringifyUpdateLog=void 0;var u=n(249),s=o(n(147)),d=l(n(554)),f=n(43),p=n(850);t.stringifyUpdateLog=function(e){return"v".concat(e.version," ").concat(e.date," ").concat(e.messages)},t.getCopyrightAndVersionElement=function(){var e=document.createElement("a");return e.innerText="ⓚ design © V".concat(s["werp-version"]),e.style.textAlign="right",e.style.padding="0.25rem 0",e.title=d.default.slice(0,5).map(t.stringifyUpdateLog).join("\n"),e.href="https://github.com/kenny0960/TampermonkeyScripts/tree/master/src/werp",e.target="_blank",e},t.createAttendanceButton=function(e,t){var n=document.createElement("a");return""!==t&&(n.href=t),n.innerText=e,n.title=e,n.className="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only atnd-btn common-btn atndreccssBth attendBtnCss",n.target="_blank",n.style.background="white",n.style.border="1px solid #c4c4c4",n.style.boxSizing="border-box",n.style.boxShadow="0px 2px 5px rgb(0 0 0 / 25%)",n.style.borderRadius="4px",n.style.width="fit-content",n.style.padding="0 3px",n},t.getCameraIcon=function(){var e=document.createElement("i");return e.className="fa fa-camera",e.style.cursor="pointer",e},t.getSendIcon=function(e){void 0===e&&(e="");var t=document.createElement("i");return t.id=e,t.className="fa fa-paper-plane",t.style.cursor="pointer",t},t.prependSendAttendancesButton=function(e){var n=document.querySelector('table[id="formTemplate:attend_rec_panel-title"] .ui-panel-content');if(null!==n&&!0!==n.innerHTML.includes("fa-paper-plane")){if(!1!==p.HAS_LINE_MESSAGE_API_AUTH){var a=(0,t.createAttendanceButton)("","");a.style.padding="0 10px",a.onclick=function(){(0,f.sendAttendances)(e)},a.insertAdjacentElement("afterbegin",(0,t.getSendIcon)()),n.prepend(a)}}else(0,u.log)("傳送出缺勤按鍵已經載入")},t.prependSendAttendancesScreenshotButton=function(){var e=document.querySelector('table[id="formTemplate:attend_rec_panel-title"] .ui-panel-content');if(null!==e&&!0!==e.innerHTML.includes("camera")){if(!1!==p.HAS_LINE_MESSAGE_API_AUTH){var n=(0,t.createAttendanceButton)("","");n.style.padding="0 10px",n.onclick=function(){return i(void 0,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,(0,f.sendAttendancesScreenshot)()];case 1:return e.sent(),[2]}}))}))},n.insertAdjacentElement("afterbegin",(0,t.getCameraIcon)()),e.prepend(n)}}else(0,u.log)("傳送出缺勤截圖按鍵已經載入")},t.prependForgottenAttendanceButton=function(){var e=document.querySelector('table[id="formTemplate:attend_rec_panel-title"] .ui-panel-content');if(null!==e&&!0!==e.innerText.includes("忘簽到退")){var n=(0,t.createAttendanceButton)("忘簽到退","/hr-attendance/acs/personal/personal-acs-aply.xhtml");e.prepend(n)}else(0,u.log)("忘簽到退按鍵已經載入")},t.restyleAttendanceButtons=function(){document.querySelectorAll("#formTemplate\\:attend_rec_panel-title .ui-panel-content > *").forEach((function(e){e.style.marginRight="4px"}))},t.restyleAttendanceTable=function(e){e.parentElement.parentElement.parentElement.parentElement.style.height="100%",e.parentElement.parentElement.parentElement.style.height="100%",e.parentElement.parentElement.style.height="100%"},t.restyleWholePage=function(){document.querySelector("#todo-bpm").parentElement.className=document.querySelector("#todo-bpm").parentElement.className.replace(/col-xl-9/,"col-xl-8"),document.querySelector("#right-top-layout").className=document.querySelector("#right-top-layout").className.replace(/col-xl-3/,"col-xl-4"),document.querySelector("#anno-layout").className=document.querySelector("#anno-layout").className.replace(/col-xl-9/,"col-xl-8"),document.querySelector("#check-in-out-layout").className=document.querySelector("#check-in-out-layout").className.replace(/col-xl-3/,"col-xl-4")}},650:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.getLeaveNoteTemplate=t.getAttendanceSignOutTemplate=t.getAttendanceSignOutLeftMinutesTemplate=t.getAttendanceSignInTemplate=t.getAttendanceDateTemplate=t.getCompanyEmployeeTemplate=t.getLeaveReceiptNotesTemplate=t.getLeaveReceiptNoteStatusIconTemplate=t.getAnnualLeaveTemplate=t.getProgressBarTemplate=t.getAttendanceSummaryTemplate=void 0;var r=a(n(488)),o=n(350),i=a(n(300)),c=a(n(116)),l=n(606),u=n(850),s=n(1);t.getAttendanceSummaryTemplate=function(e){var t=(0,l.getSummaryRemainMinutes)(e);return'\n        <span style="letter-spacing: 1px; font-weight: bold; color: '.concat(t>=0?"green":"red",';">\n            ').concat(t>=0?"+".concat(t):t,"\n        </span>\n    ")},t.getProgressBarTemplate=function(e){return'\n        <tr class="progress-bar-tr" style="display: none;"></tr>\n        <tr class="progress-bar-tr" id="predicted-sign-out-progress-bar">\n            <td colspan="4" style="padding-top: 0; height: 35px;">\n                <div style="position: relative;">\n                    <div class="progress" style="height: 30px;">\n                        <div class="'.concat(e.leftBar.class,'" style="width: ').concat(e.percentage,'%; font-size: 16px; font-weight: bold">').concat(e.leftBar.text,'</div>\n                    </div>\n                    <div style="position: absolute;top: 0;right: 12px;font-size: 18px;font-weight: bold;line-height: 30px;color: ').concat(e.rightBar.color,';">\n                        <i class="fa fa-sign-out" aria-hidden="true"></i>').concat(e.rightBar.text,"\n                    </div>\n                </div>\n            </td>\n        </tr>\n    ")},t.getAnnualLeaveTemplate=function(e){if(null===e)return"";var t=(0,r.default)(Number(i.default.getByKey(c.default.AJAX_ANNUAL_LEAVE_TIMESTAMP))).fromNow();return'\n        <div id="annual-leave-template">\n            <div class="ui-outputpanel ui-widget">\n              <div class="ui-g-12 waiting-task-g">\n                <div class="title-name ui-g-4 ">特休狀況\n                </div>\n                <div class="ui-g-8 ">\n                  <span class="todocss">\n                    <ul class="todo-ul-list">\n                      <li>\n                        <img id="formTemplate:j_idt329:0:j_idt331" src="/portal/javax.faces.resource/werp_blue.png.xhtml?ln=images" alt="">\n                        <label id="formTemplate:j_idt329:0:j_idt333" class="ui-outputlabel ui-widget" style=" width: 0px;"></label>\n                        已休(含在途)：'.concat(e.leaveHours,'\n                      </li>\n                      <li>\n                        <img id="formTemplate:j_idt329:2:j_idt332" src="/portal/javax.faces.resource/werp_red.png.xhtml?ln=images" alt="">\n                        <label id="formTemplate:j_idt329:2:j_idt333" class="ui-outputlabel ui-widget" style=" width: 0px;"></label>\n                        <a href="/hr-attendance/leave/personal/personal-apply.xhtml" target="_blank" class="select-link-red">未休：').concat(e.notLeaveHours,'</a>\n                      </li>\n                      <li>\n                        <img id="formTemplate:j_idt329:0:j_idt331" src="/portal/javax.faces.resource/werp_blue.png.xhtml?ln=images" alt="">\n                        <label id="formTemplate:j_idt329:0:j_idt333" class="ui-outputlabel ui-widget" style=" width: 0px;"></label>\n                        有效日：').concat(e.endDatetime,'\n                      </li>\n                      <li style="text-align: end;font-size: 12px;">\n                        最後更新：').concat(t,'\n                        <i id="update-annual-leave" class="fa fa-refresh" style="cursor: pointer;"></i>\n                        ').concat(!0===u.HAS_LINE_MESSAGE_API_AUTH?(0,s.getSendIcon)("send-annual-leave").outerHTML:"",'\n                      </li>\n                    </ul>\n                  </span>\n                </div>\n              </div>\n            </div>\n            <table id="formTemplate:j_idt319" class="ui-panelgrid ui-widget" style=" width: 100%; border: none;margin-top: 2px;margin-bottom: 2px; " role="grid"><tbody><tr class="ui-widget-content ui-panelgrid-even" role="row"><td role="gridcell" class="ui-panelgrid-cell" style="border-bottom-color: #C4C4C4;border-bottom-width: 0.5px;border-top-color: white;                                border-left-color: white;border-right-color: white;"></td></tr></tbody></table>\n        </div>\n    ')},t.getLeaveReceiptNoteStatusIconTemplate=function(e){return!0===e.isCanceled?'<i style="color: #dc3545;" class="fa fa-ban" aria-hidden="true"></i>':"結案"===e.status?'<i style="color: darkgreen;" class="fa fa-1 fa-check-square-o"></i>':'<i style="color: chocolate;" class="fa fa-spinner fa-1 fa-spin fa-fw"></i>'},t.getLeaveReceiptNotesTemplate=function(e){for(var n=[],a=(0,r.default)(Number(i.default.getByKey(c.default.AJAX_LEAVE_RECEIPT_NOTES_TIMESTAMP))).fromNow(),o=0,l=e.reverse();o<l.length;o++){var d=l[o],f=(0,r.default)(d.start),p=(0,r.default)(d.end);"結案"===d.status&&!0===f.isBefore((0,r.default)())||n.push('\n            <tr style="'.concat(f.isBefore((0,r.default)())?"opacity: 0.5;":"",'" >\n                <td class="align-middle">\n                    ').concat((0,t.getLeaveReceiptNoteStatusIconTemplate)(d),'\n                </td>\n                <td class="align-middle">\n                    ').concat(d.type,'\n                </td>\n                <td class="align-middle">\n                    ').concat(f.format("YYYY/MM/DD (dd) HH:mm",{trim:!1}),"\n                    <br />\n                    ").concat(p.format("YYYY/MM/DD (dd) HH:mm",{trim:!1}),'\n                </td>\n                <td class="align-middle">\n                    ').concat(d.hours,'\n                </td>\n                <td class="align-middle">\n                    <a style="color: #000FFF; text-decoration: underline;" href="../../hr-attendance/leave/personal/personal-apply.xhtml?single-form=portal&form-sid=').concat(d.id,'" target="_blank">\n                        ').concat(d.status,"\n                        ").concat(!0===d.isCanceled?'<br /><span class="badge badge-danger">已銷假</span>':"",'\n                    </a>\n                </td>\n                 <td class="align-middle">\n                    ').concat(f.fromNow(),"\n                </td>\n            </tr>\n        "))}return 0===n.length?"":'\n        <div id="leave-receipt-note-template">\n            <div class="ui-outputpanel ui-widget">\n              <div class="ui-g-12 waiting-task-g">\n                <div class="title-name ui-g-4">近期請假狀況</div>\n                <div class="ui-g-8">\n                  <span class="todocss">\n                    <table style="font-size: 12px; margin-bottom: 0;" class="table table-striped table-sm text-center">\n                      <caption class="text-right" style="color: #4f4f4f; padding: 0.25rem 0;">\n                        最後更新：'.concat(a,'\n                        <i id="update-leave-receipt-note" class="fa fa-refresh" style="cursor: pointer;"></i>\n                        ').concat(!0===u.HAS_LINE_MESSAGE_API_AUTH?(0,s.getSendIcon)("send-leave-receipt-note").outerHTML:"",'\n                      </caption>\n                      <thead class="table-borderless">\n                        <tr>\n                          <th style="width:8px"></th>\n                          <th>假別</th>\n                          <th style="width:130px">時間</th>\n                          <th style="width:40px">小時</th>\n                          <th>狀態</th>\n                          <th></th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        ').concat(n.join(""),'\n                      </tbody>\n                    </table>\n                  </span>\n                </div>\n              </div>\n            </div>\n            <table id="formTemplate:j_idt319" class="ui-panelgrid ui-widget" style=" width: 100%; border: none;margin-top: 2px;margin-bottom: 2px; " role="grid"><tbody><tr class="ui-widget-content ui-panelgrid-even" role="row"><td role="gridcell" class="ui-panelgrid-cell" style="border-bottom-color: #C4C4C4;border-bottom-width: 0.5px;border-top-color: white;                                border-left-color: white;border-right-color: white;"></td></tr></tbody></table>\n        </div>\n    ')},t.getCompanyEmployeeTemplate=function(){var e=(0,r.default)(Number(i.default.getByKey(c.default.AJAX_COMPANY_EMPLOYEE_COUNT_TIMESTAMP))).fromNow();return'\n        <div id="company-employee-count-template">\n            <table id="formTemplate:j_idt319" class="ui-panelgrid ui-widget" style=" width: 100%; border: none;margin-top: 2px;margin-bottom: 2px; " role="grid"><tbody><tr class="ui-widget-content ui-panelgrid-even" role="row"><td role="gridcell" class="ui-panelgrid-cell" style="border-bottom-color: #C4C4C4;border-bottom-width: 0.5px;border-top-color: white;                                border-left-color: white;border-right-color: white;"></td></tr></tbody></table>\n            <div id="formTemplate:j_idt323" class="ui-outputpanel ui-widget">\n              <div class="ui-g-12 waiting-task-g">\n                <div class="title-name" style="padding: 5px 0">公司在職人數\n                </div>\n                <div class="ui-g-12">\n                  <span class="todocss">\n                    <ul class="todo-ul-list">\n                      <li>\n                        <canvas id="company_employee_count"></canvas>\n                      </li>\n                      <li style="text-align: end;font-size: 12px;">\n                        最後更新：'.concat(e,'\n                        <i id="update-company-employee-count" class="fa fa-refresh" style="cursor: pointer;"></i>\n                         ').concat(!0===u.HAS_LINE_MESSAGE_API_AUTH?(0,s.getSendIcon)("send-company-employee-count").outerHTML:"","\n                      </li>\n                    </ul>\n                  </span>\n                </div>\n              </div>\n            </div>\n        </div>\n    ")},t.getAttendanceDateTemplate=function(e){return"\n        <td>\n            ".concat(e.signInDate.format("MM/DD",{trim:!1})," (").concat((0,o.formatWeekday)(e.signInDate),")\n        </td>\n    ")},t.getAttendanceSignInTemplate=function(e){var t=(0,o.formatTime)(e.signInDate);return""===t&&!0===(0,o.isToday)(e.signInDate)?'\n            <td>\n                <i style="color: crimson;" class="fa fa-1 fa-exclamation-triangle" aria-hidden="true"></i> 未簽到\n            </td>\n        ':"<td>".concat(t,"</td>")},t.getAttendanceSignOutLeftMinutesTemplate=function(e){var t=(0,l.getRemainMinutes)(e),n=e.signInDate.clone().add(9,"hours").diff((0,r.default)(),"minutes");return""===(0,o.formatTime)(e.signOutDate)?""==(0,o.formatTime)(e.signInDate)?"":n<0?'\n                <span style="letter-spacing:1px; font-weight:bold; color: green">\n                    (+'.concat(Math.abs(n),")\n                </span>\n            "):"":'\n        <span style="letter-spacing:1px; font-weight:bold; color: '.concat(t>=0?"green":"red",'">\n            (').concat(t>=0?"+".concat(t):t,")\n        </span>\n    ")},t.getAttendanceSignOutTemplate=function(e){var n=(0,o.formatTime)(e.signOutDate);return"\n        <td>\n            ".concat(n,"\n            ").concat((0,t.getAttendanceSignOutLeftMinutesTemplate)(e),"\n        </td>\n    ")},t.getLeaveNoteTemplate=function(e){var t=e.unusualNote,n=e.unsignedNote,a=e.receiptNote,r=[];return""!==t&&r.push('\n            <div title="'.concat(t,'">\n                <i style="color: crimson;" class="fa fa-1 fa-exclamation-triangle" aria-hidden="true"></i> 異常\n                <div style="\n                    white-space: nowrap;\n                    overflow: hidden;\n                    text-overflow: ellipsis;\n                    width: 50%;\n                    margin-left: 25%;"\n                >').concat(t,"</div>\n            </div>")),""!==n&&r.push('\n            <div title="'.concat(n,'">\n                <i style="color: chocolate;" class="fa fa-spinner fa-1 fa-spin fa-fw"></i> 簽核中\n                <div style="\n                    white-space: nowrap;\n                    overflow: hidden;\n                    text-overflow: ellipsis;\n                    width: 50%;\n                    margin-left: 25%;"\n                >').concat(n,"</div>\n            </div>")),""!==a&&r.push('\n            <div title="'.concat(a,'">\n                <i style="color: darkgreen;" class="fa fa-1 fa-check-square-o" aria-hidden="true"></i> 請假\n                <div style="\n                    white-space: nowrap;\n                    overflow: hidden;\n                    text-overflow: ellipsis;\n                    width: 50%;\n                    margin-left: 25%;"\n                >').concat(a,"</div>\n            </div>")),"\n        <td>\n            ".concat(r.join(""),"\n        </td>\n    ")}},501:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.startAttendanceTimers=t.startNotificationTimer=t.startAttendanceTimer=t.resetAttendanceTimers=void 0;var r=a(n(300)),o=a(n(116)),i=n(350),c=n(582),l=n(88),u=n(249),s=a(n(554)),d=n(71),f=n(198),p=n(282);t.resetAttendanceTimers=function(){window.clearTimeout(Number(r.default.getByKey(o.default.ATTENDANCE_TIMER))),window.clearTimeout(Number(r.default.getByKey(o.default.NOTIFICATION_TIMER)))},t.startAttendanceTimer=function(e,n){(0,f.updatePredictedSignOutTemplate)(n),(0,d.updatePredictedSignOutProgressBar)(e,n),(0,f.updateAttendanceSummary)(n),(0,c.updateAttendanceFavicon)(n);var a=window.setTimeout((function(){(0,u.log)("更新資訊"),(0,t.startAttendanceTimer)(e,n)}),1e3*p.TIMER_ATTENDANCE_SECONDS);r.default.setByKey(o.default.ATTENDANCE_TIMER,String(a))},t.startNotificationTimer=function(e){(0,l.showUpdateLogNotification)(s.default.slice(0,1)[0]),(0,l.showAttendanceNotification)(e),(0,l.showCompanyNotification)();var n=window.setTimeout((function(){(0,u.log)("顯示通知"),(0,t.startNotificationTimer)(e)}),60*p.TIMER_NOTIFICATION_MINUTES*1e3);r.default.setByKey(o.default.NOTIFICATION_TIMER,String(n))},t.startAttendanceTimers=function(e,n){for(var a=1;a<n.length;a++)!0===(0,i.isToday)(n[a].signInDate)&&((0,t.startAttendanceTimer)(e,n),(0,t.startNotificationTimer)(n))}},642:(e,t)=>{"use strict";t.__esModule=!0,t.RING_BELL_IMAGE=t.NEW_VERSION_IMAGE=t.WARNING_IMAGE=t.STITCH_IN_PAINTING_IMAGE=t.GOOD_BYE_IMAGE=void 0,t.GOOD_BYE_IMAGE="data:image/png;base64,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",t.STITCH_IN_PAINTING_IMAGE="data:image/png;base64,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",t.WARNING_IMAGE="data:image/jpeg;base64,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",t.NEW_VERSION_IMAGE="data:image/png;base64,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",t.RING_BELL_IMAGE="data:image/jpeg;base64,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"},554:(e,t)=>{"use strict";t.__esModule=!0,t.default=[{version:"4.0.1",date:"20230605 1130",messages:["公告有「置頂」文字時可以取得公告網址","允許默認導出模組","記錄 line 傳送失敗的訊息","傳送截圖成功的通知","暫時關閉簽到提示的 LINE 通知","修改公司在職人數的提示視窗位置","補上 github 的超鏈結"]},{version:"4.0.0",date:"20230503 1500",messages:["新增傳送訊息至 LINE 的功能"]},{version:"3.9.3",date:"20230331 1200",messages:["新增手動設定更新「出缺勤」和「通知視窗」更新頻率的功能"]},{version:"3.9.2",date:"20230314 1500",messages:["顯示近期請假「已銷假」的標示"]},{version:"3.9.1",date:"20230302 1100",messages:["即時更新累積至今天的剩餘分鐘數","定時更新當日的簽退內容"]},{version:"3.9.0",date:"20230215 1830",messages:["定時從伺服器取得資料","可即時更新請假、特休資訊","顯示公司公告通知視窗","顯示累積至今天的剩餘分鐘數"]},{version:"3.8.2",date:"20230201 1330",messages:["每隔十分鐘之後仍然顯示簽到退表格"]},{version:"3.8.1",date:"20230201 1300",messages:["關閉所有 ajax 行為"]},{version:"3.8.0",date:"20230117 1900",messages:["顯示今日工作進度條"]},{version:"3.7.0",date:"20230106 1200",messages:["提示未簽到","顯示更新日誌的通知視窗"]},{version:"3.6.2",date:"20221228",messages:["隱藏空的近期請假表格","解決近期請假日期參數錯誤的問題"]},{version:"3.6.1",date:"20221228",messages:["固定顯示請假記錄的單位為小時"]},{version:"3.6.0",date:"20221227",messages:["顯示近期請假狀況"]},{version:"3.5.0",date:"20221226",messages:["顯示異常、簽核中和請假的個別資訊"]},{version:"3.4.2",date:"20221223",messages:["解決更新網頁後簽到退顯示異常的問題","顯示不同禮拜的簽到退情況"]},{version:"3.4.1",date:"20221223",messages:["解決請假記錄顯示錯誤的問題"]},{version:"3.4.0",date:"20221223",messages:["自動取得請假和特休狀況的 TOKEN","已簽退就不再預測可簽退時間","顯示出缺勤「異常」的記錄"]},{version:"3.3.0",date:"20221216",messages:["移除表頭欄位和修改簽到退表格樣式","根據請假情況來調整計算已上班分鐘數"]},{version:"3.2.1",date:"20221212",messages:["解決取得考勤彙總表參數名稱異動的問題"]},{version:"3.2.0",date:"20221209",messages:["顯示忘簽到退按鍵"]},{version:"3.1.0",date:"20221202",messages:["解決請假導致預計時間錯亂的問題"]},{version:"3.0.0",date:"20221202",messages:["顯示請假資訊"]},{version:"2.4.1",date:"20221111",messages:["修正 favicon 無限增生的問題"]},{version:"2.4.0",date:"20221107",messages:["修正 favicon 失效的問題"]},{version:"2.3.9",date:"20221104",messages:["根據不同剩餘時間來顯示 favicon 樣式和網頁標題"]},{version:"2.3.8",date:"20221028",messages:["下班提示訊息和畫面一致化"]},{version:"2.3.7",date:"20221026",messages:["修改彈跳視窗「即將符合下班條件」字眼為「預計 MM 分鐘後」"]},{version:"2.3.6",date:"20221024",messages:["解決過早上班或是預測過早下班的問題"]},{version:"2.3.5",date:"20221020",messages:["顯示「符合下班條件」資訊"]},{version:"2.3.4",date:"20221018",messages:["顯示超時工作的資訊","清空重複執行的出缺勤 timer"]},{version:"2.3.2",date:"20221013",messages:["顯示更新日誌"]},{version:"2.3.1",date:"20221013",messages:["新增每五分鐘(簽到、簽退、超時工作)通知訊息視窗","通知訊息視窗點擊「關閉」後當天不會再顯示"]},{version:"2.2.0",date:"20221012",messages:["解決特休狀況失效的問題","顯示版號和版權資訊","忽略國定假日的簽退內容提示文字"]},{version:"2.1.0",date:"20221006",messages:["解決每次 werp 更新時畫面為空的問題"]},{version:"2.0.0",date:"20221003",messages:["顯示特休狀況"]}]},282:(e,t)=>{"use strict";t.__esModule=!0,t.FUN_COMPANY_EMPLOYEE_COUNT=t.TIMER_NOTIFICATION_MINUTES=t.TIMER_ATTENDANCE_SECONDS=void 0,t.TIMER_ATTENDANCE_SECONDS=GM_getValue("TIMER_ATTENDANCE_SECONDS",60),t.TIMER_NOTIFICATION_MINUTES=GM_getValue("TIMER_NOTIFICATION_MINUTES",5),t.FUN_COMPANY_EMPLOYEE_COUNT=GM_getValue("FUN_COMPANY_EMPLOYEE_COUNT",!1)},116:(e,t)=>{"use strict";var n;t.__esModule=!0,function(e){e.SIGN_OUT_ALREADY_NOTIFICATION="SIGN_OUT_ALREADY_NOTIFICATION",e.SIGN_IN_NOTIFICATION="SIGN_IN_NOTIFICATION",e.OFF_WORK_NOTIFICATION="OFF_WORK_NOTIFICATION",e.SIGN_OUT_NOTIFICATION="SIGN_OUT_NOTIFICATION",e.UPDATE_LOG_NOTIFICATION="UPDATE_LOG_NOTIFICATION",e.ATTENDANCE_TIMER="ATTENDANCE_TIMER",e.NOTIFICATION_TIMER="NOTIFICATION_TIMER",e.AJAX_LEAVE_NOTES="AJAX_LEAVE_NOTES",e.AJAX_LEAVE_NOTES_TIMESTAMP="AJAX_LEAVE_NOTES_TIMESTAMP",e.AJAX_ANNUAL_LEAVE="AJAX_ANNUAL_LEAVE",e.AJAX_ANNUAL_LEAVE_TIMESTAMP="AJAX_ANNUAL_LEAVE_TIMESTAMP",e.AJAX_LEAVE_RECEIPT_NOTES="AJAX_LEAVE_RECEIPT_NOTES",e.AJAX_LEAVE_RECEIPT_NOTES_TIMESTAMP="AJAX_LEAVE_RECEIPT_NOTES_TIMESTAMP",e.AJAX_COMPANY_EMPLOYEE_COUNT="AJAX_COMPANY_EMPLOYEE_COUNT",e.AJAX_COMPANY_EMPLOYEE_COUNT_TIMESTAMP="AJAX_COMPANY_EMPLOYEE_COUNT_TIMESTAMP"}(n||(n={})),t.default=n},247:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},a.apply(this,arguments)},r=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(r,o){function i(e){try{l(a.next(e))}catch(e){o(e)}}function c(e){try{l(a.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}l((a=a.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,a,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,a&&(r=2&o[0]?a.return:o[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,o[1])).done)return r;switch(a=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,a=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],a=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0;var c=i(n(488));n(285);var l=n(249),u=n(680),s=n(606),d=n(650),f=n(537),p=n(582),A=n(1),g=n(501),m=n(410),h=n(199),v=n(363),y=n(795),b=n(158),E=n(198),T=n(160),S=n(282),x=n(679),w=function(e){var t=e.innerText.split("\t"),n="".concat((0,y.getPickedYear)(),"/").concat(t[0].split(" ")[0]);return{signInDate:(0,c.default)("".concat(n," ").concat(t[1])),signOutDate:(0,c.default)("".concat(n," ").concat(t[2])),leaveNote:f.defaultLeaveNote}},N=function(e){return r(void 0,void 0,void 0,(function(){var t,n,r,i,c;return o(this,(function(o){switch(o.label){case 0:return!0===(t=e.parentElement.parentElement).innerText.includes("ⓚ design")?[2]:((0,p.initializeFaviconBadge)(),(0,g.resetAttendanceTimers)(),(0,l.log)("出缺勤表格已經載入"),n=e.getElementsByTagName("tr"),[4,(0,m.getLeaveNotes)()]);case 1:return r=o.sent(),i=function(e,t){for(var n=(0,s.getWeekAttendances)(t),r=0;r<e.length;r++){var o=e[r],i=w(o);if(!0===/\([日|六]\)/.test(o.innerText))break;n[i.signOutDate.day()]=a(a({},n[i.signOutDate.day()]),{signInDate:i.signInDate,signOutDate:i.signOutDate})}return n}(n,r),t.querySelector("table").remove(),t.append((0,E.getAttendanceTableElement)(i)),(0,f.appendUpdateLeaveNoteFunction)(),c=t.querySelector("table > tbody"),(0,A.prependForgottenAttendanceButton)(),(0,A.prependSendAttendancesButton)(i),(0,A.prependSendAttendancesScreenshotButton)(),(0,A.restyleAttendanceButtons)(),(0,A.restyleAttendanceTable)(c),(0,A.restyleWholePage)(),(0,g.startAttendanceTimers)(c,i),[2]}}))}))};c.default.locale("zh-tw"),(0,u.waitElementLoaded)('tbody[id="formTemplate:attend_rec_datatable_data"]').then(N),(0,u.waitElementLoaded)(".waitingTaskMClass").then((function(e){return r(void 0,void 0,void 0,(function(){var t,n,a,r,i,c;return o(this,(function(o){switch(o.label){case 0:return[4,(0,h.sleep)(1)];case 1:return o.sent(),!0===e.innerText.includes("特休狀況")?[2]:((0,l.log)("待辦事項表格已經載入"),[4,(0,m.getAnnualLeave)()]);case 2:return t=o.sent(),[4,(0,m.getLeaveReceiptNotes)()];case 3:return n=o.sent(),a=(0,d.getAnnualLeaveTemplate)(t),r=(0,d.getLeaveReceiptNotesTemplate)(n),e.insertAdjacentHTML("afterbegin",a),(0,v.appendUpdateAnnualLeaveFunction)(),e.insertAdjacentHTML("afterbegin",r),(0,b.appendUpdateLeaveReceiptNoteFunction)(),1!=S.FUN_COMPANY_EMPLOYEE_COUNT?[3,6]:[4,(0,m.getCompanyEmployeeCountObject)()];case 4:return i=o.sent(),c=(0,d.getCompanyEmployeeTemplate)(),e.insertAdjacentHTML("afterend",c),(0,T.appendUpdateCompanyEmployeeCountFunction)(),[4,(0,T.displayCompanyEmployeeCountLineChart)(i)];case 5:o.sent(),o.label=6;case 6:return[2]}}))}))})),(0,u.waitElementLoaded)("#formTemplate\\:anno-datatable_data").then((function(e){(0,x.prependSendAnnouncementButtons)(e)})),window.setInterval((function(){(0,u.waitElementLoaded)('tbody[id="formTemplate:attend_rec_datatable_data"]').then(N)}),5e3),reloadNewHome=function(){location.reload()}},502:(e,t,n)=>{e.exports=function(){"use strict";var e={"./src/index.ts":function(e,t,a){a.r(t),a.d(t,{Upload:function(){return R},UploadApiError:function(){return h}});var r=n(90);function o(){}function i(e,t,n){if(!e.s){if(n instanceof c){if(!n.s)return void(n.o=i.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(i.bind(null,e,t),i.bind(null,e,2));e.s=t,e.v=n;var a=e.o;a&&a(e)}}var c=function(){function e(){}return e.prototype.then=function(t,n){var a=new e,r=this.s;if(r){var o=1&r?t:n;if(o){try{i(a,1,o(this.v))}catch(e){i(a,2,e)}return a}return this}return this.o=function(e){try{var r=e.v;1&e.s?i(a,1,t?t(r):r):n?i(a,1,n(r)):i(a,2,r)}catch(e){i(a,2,e)}},a},e}();function l(e){return e instanceof c&&1&e.s}function u(){var e,t,n,a=(n=function(){return a=function(){e=new Promise((function(e){t=e}))},(n=function(e,t,n){for(var a;;){var r=e();if(l(r)&&(r=r.v),!r)return o;if(r.then){a=0;break}var o=n();if(o&&o.then){if(!l(o)){a=1;break}o=o.s}if(t){var u=t();if(u&&u.then&&!l(u)){a=2;break}}}var s=new c,d=i.bind(null,s,2);return(0===a?r.then(p):1===a?o.then(f):u.then(A)).then(void 0,d),s;function f(a){o=a;do{if(t&&(u=t())&&u.then&&!l(u))return void u.then(A).then(void 0,d);if(!(r=e())||l(r)&&!r.v)return void i(s,1,o);if(r.then)return void r.then(p).then(void 0,d);l(o=n())&&(o=o.v)}while(!o||!o.then);o.then(f).then(void 0,d)}function p(e){e?(o=n())&&o.then?o.then(f).then(void 0,d):f(o):i(s,1,o)}function A(){(r=e())?r.then?r.then(p).then(void 0,d):p(r):i(s,1,o)}}((function(){return void 0!==e}),void 0,(function(){return function(e,t){return e&&e.then?e.then(o):Promise.resolve()}(e)})))&&n.then?n.then(a):a();var n,a},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{return Promise.resolve(n.apply(this,e))}catch(e){return Promise.reject(e)}});return{safe:function(n){return function(e,t,n){try{var a=Promise.resolve(e());return t?a.then(t):a}catch(e){return Promise.reject(e)}}(a,(function(){return function(e,t){try{var n=e()}catch(e){return t(!0,e)}return n&&n.then?n.then(t.bind(null,!1),t.bind(null,!0)):t(!1,n)}(n,(function(n,a){return function(){if(void 0===t)throw new Error("Unable to release mutex: already released.");t(),t=void 0,e=void 0}(),function(e,t){if(e)throw t;return t}(n,a)}))}))}}}var s=n(493);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function f(e){var t="function"==typeof Map?new Map:void 0;return f=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return p(e,arguments,m(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),g(a,e)},f(e)}function p(e,t,n){return p=A()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&g(r,n.prototype),r},p.apply(null,arguments)}function A(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function g(e,t){return g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},g(e,t)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t)}(o,e);var t,n,a,r=(n=o,a=A(),function(){var e,t=m(n);if(a){var r=m(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=r.call(this,e.error.message)).errorCode=e.error.code,t.details=e.error.details,t}return t=o,Object.defineProperty(t,"prototype",{writable:!1}),t}(f(Error));function v(e,t){if(e)throw t;return t}function y(e,t){try{var n=e()}catch(e){return t(!0,e)}return n&&n.then?n.then(t.bind(null,!1),t.bind(null,!0)):t(!1,n)}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function E(){}var T=7;function S(e,t){if(!t)return e&&e.then?e.then(E):Promise.resolve()}var x="W142hJk";function w(e,t,n){if(n)return t?t(e()):e();try{var a=Promise.resolve(e());return t?a.then(t):a}catch(e){return Promise.reject(e)}}var N=["free","demo"];function I(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var _="public_",C=5;function M(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var L=20;function O(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var B=100,P=5,D="/api/v1/access_tokens/",j="[upload-js] ";function R(e){var t,n,a,o,i,c,l,d,f,p,A,g=u(),m=null!==(n=null===(t=e.internal)||void 0===t?void 0:t.apiUrl)&&void 0!==n?n:"https://api.upload.io",R=null!==(o=null===(a=e.internal)||void 0===a?void 0:a.cdnUrl)&&void 0!==o?o:"https://upcdn.io",k=null===(c=null===(i=e.internal)||void 0===i?void 0:i.authenticateWithApiKey)||void 0===c||c,F=null===(l=e.internal)||void 0===l?void 0:l.headers,Y=!0===e.debug;if(void 0===(null!=e?e:void 0))throw new Error("".concat(j,"Config parameter required."));if(!0===e.debug&&console.log("".concat(j,"Initialized with API key '").concat(e.apiKey,"'")),void 0===(null!==(d=e.apiKey)&&void 0!==d?d:void 0))throw new Error("".concat(j,"Please provide an API key via the 'apiKey' config parameter."));if(e.apiKey.trim()!==e.apiKey)throw new Error("".concat(j,"API key needs trimming (whitespace detected)."));if(!1===(null===(f=e.internal)||void 0===f?void 0:f.authenticateWithApiKey))p=e.internal.accountId;else if(N.includes(e.apiKey))p=x;else{if(!e.apiKey.startsWith(_))throw new Error("".concat(j,'API key must begin with "').concat(_,'".'));if((p=e.apiKey.substr(_.length,T)).length!==T)throw new Error("".concat(j,"API key is too short!"))}var U="".concat(R).concat(D).concat(p),G=I((function(){return S(g.safe(I((function(){if(void 0!==A){var e=A;return A=void 0,void 0!==e.accessTokenRefreshHandle&&clearTimeout(e.accessTokenRefreshHandle),e.isActive=!1,w(Q,E,undefined)}}))))})),H=I((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],a=function(e){n.push(e)},r=function(){return n.forEach((function(e){return e()}))};return void 0!==t.onBegin&&t.onBegin({cancel:r}),O((function(){return M(q(e,t,a))}),(function(e){throw r(),e}))})),q=I((function(e,t,n){var a=(0,s.ProgressSmoother)({maxValue:e.size,teardownTime:1e3,minDelayUntilFirstValue:2e3,valueIncreaseDelta:204800,valueIncreaseRatePerSecond:51200,averageTimeBetweenValues:1e3});return K(B,(function(n){if(void 0===t.onProgress)n();else{var r=a.smoothedValue(),o=e.size;r===o&&n(),t.onProgress({bytesSent:r,bytesTotal:o,progress:Math.round(r/o*100)})}}),I((function(){var o={path:t.path,metadata:t.metadata,mime:ne(e.type),originalFileName:e.name,protocol:"1.1",size:e.size,tags:t.tags};return ae("Initiating file upload. Params = ".concat(JSON.stringify(o))),M((0,r.beginMultipartUpload)(te(),p,o),(function(t){var o=$(t);ae("Initiated file upload. Metadata = ".concat(JSON.stringify(o)));var i,c,l=(i=0,function(){if(i!==o.uploadParts.count-1)return++i}),u=[o.uploadParts.first],s=I((function(e){var t=u.pop();if(void 0!==t)return ae("Dequeued part ".concat(t.uploadPartIndex,"."),e),t;var n=l();if(void 0!==n)return ae("Fetching metadata for part ".concat(n,"."),e),M((0,r.getUploadPart)(te(),p,o.uploadId,n),$);ae("No parts remaining.",e)})),d=[],f=function t(r){return M(s(r),(function(o){return function(i){var c=function(){if(void 0!==o){var i=0;return M(J(e,o,(function(e){var t=e.bytesSent;void 0===d[r]?d[r]=t:(d[r]-=i,d[r]+=t),i=t;var n=d.reduce((function(e,t){return e+t}));a.setValue(n)}),n,r),(function(){return S(t(r))}))}}();if(c&&c.then)return c.then(E)}()}))};return M(Promise.all((c=Array(C).keys(),function(e){if(Array.isArray(e))return b(e)}(c)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(c)||function(e,t){if(e){if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(e){return M(f(e))}))),(function(){var t=Object.assign({accountId:p,file:e},o.file);return ae("File upload completed."),t}))}))})))})),z=I((function(e,t,n,a){var r=new XMLHttpRequest,o=!0;return a((function(){o&&r.abort()})),y((function(){return M(new Promise((function(a,o){r.upload.addEventListener("progress",(function(e){e.lengthComputable&&n({bytesSent:e.loaded,bytesTotal:e.total})}),!1),r.addEventListener("load",(function(){if(n({bytesSent:t.size,bytesTotal:t.size}),2===Math.floor(r.status/100)){var e=r.getResponseHeader("etag");null==e?o(new Error("File upload error: no etag header in upload response.")):a({etag:e})}else o(new Error("File upload error: status code ".concat(r.status)))})),r.onabort=function(){return o(new Error("File upload cancelled."))},r.onerror=function(){return o(new Error("File upload error."))},r.ontimeout=function(){return o(new Error("File upload timeout."))},r.open("PUT",e),r.send(t)})))}),(function(e,t){return o=!1,v(e,t)}))})),J=I((function(e,t,n,a,o){var i=-1===t.range.inclusiveEnd?new Blob:e.slice(t.range.inclusiveStart,t.range.inclusiveEnd+1);return ae("Uploading part ".concat(t.uploadPartIndex,"."),o),M(z(t.uploadUrl,i,n,a),(function(e){var n=e.etag;return M((0,r.completeUploadPart)(te(),p,t.uploadId,t.uploadPartIndex,{etag:n}),(function(e){$(e),ae("Uploaded part ".concat(t.uploadPartIndex,"."),o)}))}))})),K=I((function(e,t,n){var a,r=new Promise((function(e){a=e})),o=!0,i=function(){o&&(a(),clearInterval(c),o=!1)},c=setInterval((function(){return t(i)}),e);return y((function(){return w(n,(function(e){return M(r,(function(){return e}))}))}),(function(e,t){return i(),v(e,t)}))})),Q=I((function(){return S(W(U,{},!0))})),V=I((function(e,t,n){return function(e){if(e&&e.then)return e.then(E)}(O((function(){return S(g.safe(I((function(){if(n.isActive)return w(t,(function(a){return M(Z(e,a),(function(a){return M(X(U,{},{accessToken:a},!0),(function(a){n.accessToken=a.accessToken,n.accessTokenRefreshHandle=window.setTimeout((function(){V(e,t,n).then((function(){}),(function(e){return re("Permanent error when refreshing access token: ".concat(e))}))}),Math.max(0,1e3*(a.ttlSeconds-L)))}))}))}))}))))}),(function(a){return ae("Error when refreshing access token: ".concat(a)),M(new Promise((function(e){return setTimeout(e,1e3*P)})),(function(){return S(V(e,t,n))}))})))})),X=I((function(e,t,n,a){return M(ee({method:"PUT",path:e,headers:t,body:n},a),(function(e){return M($(e))}))})),Z=I((function(e,t){return M(ee({method:"GET",path:e,headers:t},!1),(function(e){return M($(e))}))})),W=I((function(e,t,n){return M(ee({method:"DELETE",path:e,headers:t},n),(function(e){$(e)}))})),$=function(e){var t;if(e.ok)return e.body;var n=e.body;if("string"==typeof(null===(t=null==n?void 0:n.error)||void 0===t?void 0:t.code))throw new h(n);throw new Error("Unexpected API error.")},ee=I((function(e,t){return(0,r.request)({BASE:e.path,WITH_CREDENTIALS:t},Object.assign(Object.assign({},e),{path:""}))})),te=function(){var t={BASE:m,WITH_CREDENTIALS:!0};k&&(t.USERNAME="apikey",t.PASSWORD=e.apiKey);var n=null==A?void 0:A.accessToken;return void 0===F&&void 0===n||(t.HEADERS=I((function(){return M(void 0===F?{}:F(),(function(e){var t=null==A?void 0:A.accessToken;return Object.assign(Object.assign({},e),void 0===t?{}:{"authorization-token":t})}),void 0===F)}))),t},ne=function(e){var t=e.toLowerCase();return/^[a-z0-9]+\/[a-z0-9+\-._]+(?:;[^=]+=[^;]+)*$/.test(t)?t:void 0},ae=function(e,t){Y&&console.log("".concat(j).concat(e).concat(void 0!==t?" (Worker ".concat(t,")"):""))},re=function(e){console.error("".concat(j).concat(e))};return{beginAuthSession:function(e,t){return w(G,(function(){var n={accessToken:void 0,accessTokenRefreshHandle:void 0,isActive:!0};return A=n,S(V(e,t,n))}))},endAuthSession:G,uploadFile:H,url:function(e,t){var n,a="string"==typeof t?{transformation:t}:t;return"".concat(R,"/").concat(p,"/").concat(null!==(n=null==a?void 0:a.transformation)&&void 0!==n?n:"raw").concat(e).concat(!0===(null==a?void 0:a.auth)?"?_auth=true":"")}}}}},t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}return a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a("./src/index.ts")}()},980:e=>{"use strict";e.exports=Chart},177:e=>{"use strict";e.exports=html2canvas},488:e=>{"use strict";e.exports=moment},147:e=>{"use strict";e.exports=JSON.parse('{"name":"tampermonkeyscripts","version":"1.0.0","screenshot-version":"1.0.0","werp-version":"4.0.1","description":"","main":".eslintrc.js","scripts":{"lint":"prettier --write \\"src/**/*.{js,ts}\\"","build":"webpack --config webpack.werp.js && webpack --config webpack.screenshot.js","build-werp":"webpack --config webpack.werp.js","watch-werp":"webpack --config webpack.werp.js --watch","build-screenshot":"webpack --config webpack.screenshot.js","watch-screenshot":"webpack --config webpack.screenshot.js --watch"},"repository":{"type":"git","url":"git+https://github.com/kenny0960/TampermonkeyScripts.git"},"author":"","license":"ISC","bugs":{"url":"https://github.com/kenny0960/TampermonkeyScripts/issues"},"homepage":"https://github.com/kenny0960/TampermonkeyScripts#readme","devDependencies":{"eslint":"^8.9.0","prettier":"^2.7.1","sass-loader":"^13.2.2","sass-to-string":"^1.6.3","ts-loader":"^9.4.1","typescript":"^4.8.3","webpack":"^5.74.0","webpack-cli":"^4.10.0"},"dependencies":{"@types/jquery":"^3.5.16","@types/jqueryui":"^1.12.17","favicon-badge":"^2.0.0","upload-js":"^2.11.2"}}')}},t={};!function n(a){var r=t[a];if(void 0!==r)return r.exports;var o=t[a]={exports:{}};return e[a].call(o.exports,o,o.exports,n),o.exports}(247)})();